<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="12/12/2019 3:02:16 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="T1LG-MEDINFO6"
  DTS:CreatorName="AHMC\rcmartinez"
  DTS:DTSID="{514C97C0-5E41-42FB-9803-7E7F472EE5DD}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="12.0.2430.0"
  DTS:LocaleID="13321"
  DTS:ObjectName="IPD test dump  2hrs"
  DTS:PackageType="5"
  DTS:VersionBuild="129"
  DTS:VersionGUID="{8A0AAA7C-FBBD-416F-96DD-45CBE41CC909}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[DBPROD03.AHMC_DataAnalyticsDB]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{BA71D38C-B716-4CF6-A469-43B9B5CC5A15}"
      DTS:ObjectName="DBPROD03.AHMC_DataAnalyticsDB">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=DBPROD03;Initial Catalog=AHMC_DataAnalyticsDB;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[DBPROD03.AmalgaPROD]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{ED0A0913-D2A8-4628-BD34-AC5530015944}"
      DTS:ObjectName="DBPROD03.AmalgaPROD">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=DBPROD03;Initial Catalog=AmalgaPROD;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Another stage table"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{F51F0E76-B981-491D-92B0-D3374BCF887E}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Another stage table"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Another stage table\From ipd_census_1"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="From ipd_census_1"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[dbo].[ipd_census_2]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">--select count(distinct tempc.patient_visit_id)

--from (

select tempb.patient_id
	   ,tempb.patient_visit_id
	   ,tempb.[Visit Start]
	   ,tempb.[Expected Discharge Date]
	   ,tempb.[Closure Date]
	   ,tempb.cancelled_date_time
	   ,tempb.[Visit Type Name]
	   ,tempb.[Visit Reason]
	   ,tempb.[Created By]
	   ,tempb.[Place of Admission]
	   ,tempb.[Length of Stay]
	   ,tempb.[Visit Policies]
	   ,tempb.policy_id
	   ,case when tempb.[Visit Policies] = 'Self Pay' then 'policy_id is null' else tempb.[Visit Policies] end as indicator
	   ,tempb.HN
	   ,tempb.[Patient Name]
	   ,tempb.Region
	   ,tempb.Subregion
	   ,tempb.City
	   ,tempb.[Address Type]
	   ,case when tempb.Age is null then (cast(cast((DATEDIFF(dd,tempb.[Date of Birth],GETDATE()) / 365.25) as int) as varchar)) else tempb.Age end as Age
	   ,tempb.[Date of Birth]
	   ,tempb.Nationality
	   ,tempb.Race
	   ,tempb.[Ethnic Group]
	   ,tempb.Religion
	   ,tempb.Sex
	   ,tempb.[Home Country]
	   ,tempb.[Country of Residence]
	   ,tempb.[Home Address]
	   ,tempb.[Primary Service]
	   ,tempb.Ward
	   ,tempb.[Room Code]
	   ,tempb.[Room Class Name]
	   ,tempb.[Primary Doctor]
	   ,tempb.diagnosis_type_rcd
	   ,tempb.Diagnosis
	   ,tempb.[Discharge Reason]
	   ,tempb.[Discharge Notes]
	   ,tempb.[Discharge Outcome]
	   ,tempb.[Discharge Disposition]

from (

select temp.patient_id
	   ,temp.patient_visit_id
	   ,temp.[Visit Start]
	   ,temp.[Expected Discharge Date]
	   ,temp.[Closure Date]
	   ,temp.cancelled_date_time
	   ,temp.[Visit Type Name]
	   ,temp.[Visit Reason]
	   ,temp.[Created By]
	   ,temp.[Place of Admission]
	   ,temp.[Length of Stay]
	   ,temp.[Visit Policies]
	   ,temp.policy_id
	   ,temp.HN
	   ,temp.[Patient Name]
	   ,temp.Region
	   ,temp.Subregion
	   ,temp.City
	   ,temp.[Address Type]
	   ,temp.Age
	   ,temp.[Date of Birth]
	   ,temp.Nationality
	   ,temp.Race
	   ,temp.[Ethnic Group]
	   ,temp.Religion
	   ,temp.Sex
	   ,temp.home_address_country_rcd
	   ,temp.[Home Country]
	   ,temp.residence_country_rcd
	   ,temp.[Country of Residence]
	   ,temp.[Home Address]
	   ,temp.[Primary Service]
	   ,temp.Ward
	   ,temp.[Room Code]
	   ,temp.[Room Class Name]
	   ,temp.[Primary Doctor]
	   ,pvdv.diagnosis_type_rcd
	   ,pvdv.coding_type_rcd
	   ,pvdv.active_flag
	   ,pvdv.primary_flag
	   ,pvdv.current_visit_diagnosis_flag
	   ,csed.coding_system_rcd
       ,csed.description as Diagnosis
	   ,temp.[Discharge Reason]
	   ,temp.[Discharge Notes]
	   ,temp.[Discharge Outcome]
	   ,temp.[Discharge Disposition]

from (

select distinct apv.patient_id
	   ,api.patient_visit_id
	   ,api.actual_visit_date_time as [Visit Start]
	   ,api.expected_discharge_date_time as [Expected Discharge Date]
	   ,api.closure_date_time as [Closure Date]
	   ,api.cancelled_date_time
	   ,api.visit_type_name_l as [Visit Type Name]
	   --,stuff((select '; ' + name_l from patient_visit_reason a1 left join visit_reason_ref a2 on a1.visit_reason_rcd = a2.visit_reason_rcd
				--														where a1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Reason]
	   ,vrr.name_l as [Visit Reason]
	   ,emp1.display_name_l as [Created By]
	   ,api.created_from_area_name_l as [Place of Admission]
	   ,datediff(dd,api.actual_visit_date_time,api.closure_date_time) as [Length of Stay]
	   --,stuff((select '; ' + b1.policy_name_l from api_patient_visit_policy_view b1 where b1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Policies]
	   ,ISNULL(apvp.policy_name_l, 'Self Pay') as [Visit Policies]
	   ,apvp.policy_id
	   ,apv.visible_patient_id as HN
	   ,apv.display_name_l as [Patient Name]
	   ,case when ADNV.city is NULL then city.city_id else ADNV.city_id end as city_id
	   ,case when ADNV.city is NULL then city.name_l else ADNV.city end as City
	   ,case when adnv.city_id is NOT NULL then  (SELECT region_id
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT region_id								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as region_id
	   ,case when adnv.city_id is NOT NULL then  (SELECT name_l
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT name_l								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as Region
	    ,case when adnv.city_id is not NULL then (SELECT subr.subregion_id as subregion
															from AmalgaPROD.dbo.subregion_nl_view subr
															where subr.subregion_id = city.subregion_id) else (SELECT subr.subregion_id as subregion
																												from AmalgaPROD.dbo.subregion_nl_view subr
																												where subr.subregion_id = adnv.subregion_id) end as subregion_id
		,case when adnv.city_id is not NULL then (SELECT subr.name_l as subregion
													from AmalgaPROD.dbo.subregion_nl_view subr
													where subr.subregion_id = adnv.subregion_id) else (SELECT subr.name_l as subregion
																										from AmalgaPROD.dbo.subregion_nl_view subr
																										where subr.subregion_id = adnv.subregion_id) end as Subregion
		,case when panv.person_address_type_rcd is NULL then 'N/A' ELSE panv.person_address_type_rcd end as [Address Type]
		--,datediff(dd,apv.date_of_birth, getdate()) / 365 as Age
		,cast(cast((DATEDIFF(dd,apv.date_of_birth,api.closure_date_time) / 365.25) as int) as varchar) as Age
		,apv.date_of_birth as [Date of Birth]
		,apv.nationality_rcd
		,apv.nationality_name_l as Nationality
		,apv.race_name_l as Race
		,case when apv.ethnic_group_name_l_list is null then 'Unknown' else apv.ethnic_group_name_l_list end as [Ethnic Group]
		,apv.religion_name_l as Religion
		,apv.sex_name_l as Sex
		,case when apv.home_address_country_rcd is null then 'UNK' else apv.home_address_country_rcd end as home_address_country_rcd
		,case when apv.home_address_country_name_l is null then 'Unknown' else apv.home_address_country_name_l end as [Home Country]
		,apv.residence_country_rcd
		,apv.residence_country_name_l as [Country of Residence]
		,ISNULL(apv.home_address_line_1_l,'') + ' ' + ISNULL(apv.home_address_line_2_l,'') + ISNULL(apv.home_address_line_3_l,'') as [Home Address]
		,api.primary_service_name_l as [Primary Service]
		,(select top 1 ward_name_l from bed_entry_info_view t1 
					where t1.patient_visit_id = api.patient_visit_id
					order by start_date_time desc) as Ward
	    ,api.admission_bed_code as [Room Code]
		,api.admission_room_charge_set_name_l as [Room Class Name]
		,emp2.display_name_l as [Primary Doctor]
		,api.discharge_reason_name_l as [Discharge Reason]
		,api.discharge_notes as [Discharge Notes]
		,api.discharge_outcome_name_l as [Discharge Outcome]
		,api.discharge_disposition_name_l as [Discharge Disposition]

FROM api_patient_visit_view api 
			left join api_patient_view apv on api.patient_id = apv.patient_id
			left join user_account ua on api.created_by = ua.user_id
			left join person_formatted_name_iview emp1 on ua.person_id = emp1.person_id
			left join api_patient_visit_policy_view apvp on api.patient_visit_id = apvp.patient_visit_id
			left join address_label_view al on apv.home_address_id = al.address_id
			left join person_address_nl_view panv ON apv.patient_id = panv.person_id
			left join address_nl_view adnv ON al.address_id = adnv.address_id
			left join city_nl_view city on ADNV.city_id = city.city_id
			left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
			left join person_formatted_name_iview emp2 on emp2.person_id = cr.employee_id
			left join patient_visit_reason pvr on api.patient_visit_id = pvr.patient_visit_id
			left join visit_reason_ref vrr on pvr.visit_reason_rcd = vrr.visit_reason_rcd
			--left join country_ref cref on apv.home_address_country_rcd = cref.country_rcd


where 
	  cancelled_date_time is null
      and api.visit_type_rcd in ('V1', 'V2')
      --and discharge_status_rcd = 'COM'
	  --and panv.effective_until_date is null 
	  and cr.caregiver_role_type_rcd = 'PRIDR'
	  and cr.caregiver_role_status_rcd = 'ACTIV'
	  --and api.visible_patient_id in ('00006719', '00509908', '00032498')  
      --and last_status_rcd is NULL

) as temp
			left join patient_visit_diagnosis_view pvdv on pvdv.patient_visit_id = temp.patient_visit_id
			left join coding_system_element_description csed on csed.code = pvdv.code

where temp.[Address Type] in ('H1','N/A')
	  and (csed.coding_system_rcd is null or csed.coding_system_rcd in ('ICD10', 'ICD9CM'))
	  --and (pvdv.coding_type_rcd is null or pvdv.coding_type_rcd = 'PRI')
	  and isnull(pvdv.current_visit_diagnosis_flag,0) = 1
      and (select count(*) from patient_visit_diagnosis_view
				where patient_visit_id = pvdv.patient_visit_id
				and current_visit_diagnosis_flag = 1) &gt; 0

UNION ALL

select temp.patient_id
	   ,temp.patient_visit_id
	   ,temp.[Visit Start]
	   ,temp.[Expected Discharge Date]
	   ,temp.[Closure Date]
	   ,temp.cancelled_date_time
	   ,temp.[Visit Type Name]
	   ,temp.[Visit Reason]
	   ,temp.[Created By]
	   ,temp.[Place of Admission]
	   ,temp.[Length of Stay]
	   ,temp.[Visit Policies]
	   ,temp.policy_id
	   ,temp.HN
	   ,temp.[Patient Name]
	   ,temp.Region
	   ,temp.Subregion
	   ,temp.City
	   ,temp.[Address Type]
	   ,temp.Age
	   ,temp.[Date of Birth]
	   ,temp.Nationality
	   ,temp.Race
	   ,temp.[Ethnic Group]
	   ,temp.Religion
	   ,temp.Sex
	   ,temp.home_address_country_rcd
	   ,temp.[Home Country]
	   ,temp.residence_country_rcd
	   ,temp.[Country of Residence]
	   ,temp.[Home Address]
	   ,temp.[Primary Service]
	   ,temp.Ward
	   ,temp.[Room Code]
	   ,temp.[Room Class Name]
	   ,temp.[Primary Doctor]
	   ,pvdv.diagnosis_type_rcd
	   ,pvdv.coding_type_rcd
	   ,pvdv.active_flag
	   ,pvdv.primary_flag
	   ,pvdv.current_visit_diagnosis_flag
	   ,csed.coding_system_rcd
       ,csed.description as Diagnosis
	   ,temp.[Discharge Reason]
	   ,temp.[Discharge Notes]
	   ,temp.[Discharge Outcome]
	   ,temp.[Discharge Disposition]

from (

select distinct apv.patient_id
	   ,api.patient_visit_id
	   ,api.actual_visit_date_time as [Visit Start]
	   ,api.expected_discharge_date_time as [Expected Discharge Date]
	   ,api.closure_date_time as [Closure Date]
	   ,api.cancelled_date_time
	   ,api.visit_type_name_l as [Visit Type Name]
	   --,stuff((select '; ' + name_l from patient_visit_reason a1 left join visit_reason_ref a2 on a1.visit_reason_rcd = a2.visit_reason_rcd
				--														where a1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Reason]
	   ,vrr.name_l as [Visit Reason]
	   ,emp1.display_name_l as [Created By]
	   ,api.created_from_area_name_l as [Place of Admission]
	   ,datediff(dd,api.actual_visit_date_time,api.closure_date_time) as [Length of Stay]
	   --,stuff((select '; ' + b1.policy_name_l from api_patient_visit_policy_view b1 where b1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Policies]
	   ,ISNULL(apvp.policy_name_l, 'Self Pay') as [Visit Policies]
	   ,apvp.policy_id
	   ,apv.visible_patient_id as HN
	   ,apv.display_name_l as [Patient Name]
	   ,case when ADNV.city is NULL then city.city_id else ADNV.city_id end as city_id
	   ,case when ADNV.city is NULL then city.name_l else ADNV.city end as City
	   ,case when adnv.city_id is NOT NULL then  (SELECT region_id
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT region_id								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as region_id
	   ,case when adnv.city_id is NOT NULL then  (SELECT name_l
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT name_l								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as Region
		,case when adnv.city_id is not NULL then (SELECT subr.subregion_id as subregion
															from AmalgaPROD.dbo.subregion_nl_view subr
															where subr.subregion_id = city.subregion_id) else (SELECT subr.subregion_id as subregion
																												from AmalgaPROD.dbo.subregion_nl_view subr
																												where subr.subregion_id = adnv.subregion_id) end as subregion_id
		,case when adnv.city_id is not NULL then (SELECT subr.name_l as subregion
													from AmalgaPROD.dbo.subregion_nl_view subr
													where subr.subregion_id = adnv.subregion_id) else (SELECT subr.name_l as subregion
																										from AmalgaPROD.dbo.subregion_nl_view subr
																										where subr.subregion_id = adnv.subregion_id) end as Subregion
		,case when panv.person_address_type_rcd is NULL then 'N/A' ELSE panv.person_address_type_rcd end as [Address Type]
		--,datediff(dd,apv.date_of_birth, getdate()) / 365 as Age
		,cast(cast((DATEDIFF(dd,apv.date_of_birth,api.closure_date_time) / 365.25) as int) as varchar) as Age
		,apv.date_of_birth as [Date of Birth]
		,apv.nationality_rcd
		,apv.nationality_name_l as Nationality
		,apv.race_name_l as Race
		,case when apv.ethnic_group_name_l_list is null then 'Unknown' else apv.ethnic_group_name_l_list end as [Ethnic Group]
		,apv.religion_name_l as Religion
		,apv.sex_name_l as Sex
		,case when apv.home_address_country_rcd is null then 'UNK' else apv.home_address_country_rcd end as home_address_country_rcd
		,case when apv.home_address_country_name_l is null then 'Unknown' else apv.home_address_country_name_l end as [Home Country]
		,apv.residence_country_rcd
		,apv.residence_country_name_l as [Country of Residence]
		,ISNULL(apv.home_address_line_1_l,'') + ' ' + ISNULL(apv.home_address_line_2_l,'') + ISNULL(apv.home_address_line_3_l,'') as [Home Address]
		,api.primary_service_name_l as [Primary Service]
		,(select top 1 ward_name_l from bed_entry_info_view t1 
					where t1.patient_visit_id = api.patient_visit_id
					order by start_date_time desc) as Ward
	    ,api.admission_bed_code as [Room Code]
		,api.admission_room_charge_set_name_l as [Room Class Name]
		,emp2.display_name_l as [Primary Doctor]
		,api.discharge_reason_name_l as [Discharge Reason]
		,api.discharge_notes as [Discharge Notes]
		,api.discharge_outcome_name_l as [Discharge Outcome]
		,api.discharge_disposition_name_l as [Discharge Disposition]

FROM api_patient_visit_view api 
			left join api_patient_view apv on api.patient_id = apv.patient_id
			left join user_account ua on api.created_by = ua.user_id
			left join person_formatted_name_iview emp1 on ua.person_id = emp1.person_id
			left join api_patient_visit_policy_view apvp on api.patient_visit_id = apvp.patient_visit_id
			left join address_label_view al on apv.home_address_id = al.address_id
			left join person_address_nl_view panv ON apv.patient_id = panv.person_id
			left join address_nl_view adnv ON al.address_id = adnv.address_id
			left join city_nl_view city on ADNV.city_id = city.city_id
			left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
			left join person_formatted_name_iview emp2 on emp2.person_id = cr.employee_id
			left join patient_visit_reason pvr on api.patient_visit_id = pvr.patient_visit_id
			left join visit_reason_ref vrr on pvr.visit_reason_rcd = vrr.visit_reason_rcd
			--left join country_ref cref on apv.home_address_country_rcd = cref.country_rcd

where 
	  cancelled_date_time is null
      and api.visit_type_rcd in ('V1', 'V2')
      --and discharge_status_rcd = 'COM'
	  --and panv.effective_until_date is null 
	  and cr.caregiver_role_type_rcd = 'PRIDR'
	  and cr.caregiver_role_status_rcd = 'ACTIV'
	  --and api.visible_patient_id in ('00006719', '00509908', '00032498')  
      --and last_status_rcd is NULL

) as temp
			left join patient_visit_diagnosis_view pvdv on temp.patient_visit_id = pvdv.patient_visit_id
			left join coding_system_element_description csed on pvdv.code = csed.code

where temp.[Address Type] in ('H1','N/A')
	  and (csed.coding_system_rcd is null or csed.coding_system_rcd in ('ICD10', 'ICD9CM'))
	  and (pvdv.coding_type_rcd is null or pvdv.coding_type_rcd = 'PRI')
      and (select count(*) from patient_visit_diagnosis_view
				where patient_visit_id = pvdv.patient_visit_id
				and current_visit_diagnosis_flag = 1) = 0

) as tempb
where 
      --year(tempb.[Visit Start]) = 2018
      --and month(tempb.[Visit Start]) = 11
	   CAST(CONVERT(VARCHAR(10),tempb.[Visit Start],101) as SMALLDATETIME) &gt;= CAST(CONVERT(VARCHAR(10),'01/01/2019',101) as SMALLDATETIME)
	  and CAST(CONVERT(VARCHAR(10),tempb.[Visit Start],101) as SMALLDATETIME) &lt;= CAST(CONVERT(VARCHAR(10),'12/19/2019',101) as SMALLDATETIME)
	  --and tempb.HN in ('00007616')
	  --and tempb.[Room Code] not like '%-%'
--and tempb.patient_visit_id = '6C9BD8C5-1C08-11EA-A0C3-484D7EF1A97B'
	  
--) as tempc
order by tempb.[Closure Date] DESC</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">0</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\Another stage table\From ipd_census_1.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[DBPROD03.AHMC_DataAnalyticsDB]"
                  connectionManagerRefId="Package.ConnectionManagers[DBPROD03.AHMC_DataAnalyticsDB]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[patient_id]"
                      dataType="guid"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[patient_id]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[patient_id]"
                      name="patient_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[patient_visit_id]"
                      dataType="guid"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[patient_visit_id]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[patient_visit_id]"
                      name="patient_visit_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Start]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Visit Start]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Start]"
                      name="Visit Start"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Expected Discharge Date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Expected Discharge Date]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Expected Discharge Date]"
                      name="Expected Discharge Date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Closure Date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Closure Date]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Closure Date]"
                      name="Closure Date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[cancelled_date_time]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[cancelled_date_time]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[cancelled_date_time]"
                      name="cancelled_date_time"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Type Name]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Visit Type Name]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Type Name]"
                      name="Visit Type Name"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Reason]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Visit Reason]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Reason]"
                      name="Visit Reason"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Created By]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Created By]"
                      length="256"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Created By]"
                      name="Created By"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Place of Admission]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Place of Admission]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Place of Admission]"
                      name="Place of Admission"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Length of Stay]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Length of Stay]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Length of Stay]"
                      name="Length of Stay"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[policy_id]"
                      dataType="guid"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[policy_id]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[policy_id]"
                      name="policy_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Policies]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Visit Policies]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Policies]"
                      name="Visit Policies"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[HN]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[HN]"
                      length="20"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[HN]"
                      name="HN"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Patient Name]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Patient Name]"
                      length="256"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Patient Name]"
                      name="Patient Name"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Region]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Region]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Region]"
                      name="Region"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Subregion]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Subregion]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Subregion]"
                      name="Subregion"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[City]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[City]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[City]"
                      name="City"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Address Type]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Address Type]"
                      length="3"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Address Type]"
                      name="Address Type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Age]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Age]"
                      length="30"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Age]"
                      name="Age"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Date of Birth]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Date of Birth]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Date of Birth]"
                      name="Date of Birth"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Nationality]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Nationality]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Nationality]"
                      name="Nationality"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Race]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Race]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Race]"
                      name="Race"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Ethnic Group]"
                      dataType="nText"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Ethnic Group]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Ethnic Group]"
                      name="Ethnic Group"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Religion]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Religion]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Religion]"
                      name="Religion"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Sex]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Sex]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Sex]"
                      name="Sex"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Home Country]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Home Country]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Home Country]"
                      name="Home Country"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Country of Residence]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Country of Residence]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Country of Residence]"
                      name="Country of Residence"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Home Address]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Home Address]"
                      length="241"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Home Address]"
                      name="Home Address"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Primary Service]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Primary Service]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Primary Service]"
                      name="Primary Service"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Ward]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Ward]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Ward]"
                      name="Ward"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Room Code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Room Code]"
                      length="20"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Room Code]"
                      name="Room Code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Room Class Name]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Room Class Name]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Room Class Name]"
                      name="Room Class Name"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Primary Doctor]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Primary Doctor]"
                      length="256"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Primary Doctor]"
                      name="Primary Doctor"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[diagnosis_type_rcd]"
                      length="5"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[diagnosis_type_rcd]"
                      name="diagnosis_type_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Diagnosis]"
                      dataType="nText"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Diagnosis]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Diagnosis]"
                      name="Diagnosis"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Reason]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Discharge Reason]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Reason]"
                      name="Discharge Reason"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Notes]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Discharge Notes]"
                      length="3000"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Notes]"
                      name="Discharge Notes"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Outcome]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Discharge Outcome]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Outcome]"
                      name="Discharge Outcome"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Disposition]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Discharge Disposition]"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Disposition]"
                      name="Discharge Disposition"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[visit_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[visit_type_rcd]"
                      length="6"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[visit_type_rcd]"
                      name="visit_type_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[nationality_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[nationality_rcd]"
                      length="3"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[nationality_rcd]"
                      name="nationality_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[ethnic_group_rcd_list]"
                      dataType="nText"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[ethnic_group_rcd_list]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[ethnic_group_rcd_list]"
                      name="ethnic_group_rcd_list"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[religion_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[religion_rcd]"
                      length="5"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[religion_rcd]"
                      name="religion_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[sex_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[sex_rcd]"
                      length="1"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[sex_rcd]"
                      name="sex_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[home_address_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[home_address_country_rcd]"
                      length="3"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[home_address_country_rcd]"
                      name="home_address_country_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[residence_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[residence_country_rcd]"
                      length="3"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[residence_country_rcd]"
                      name="residence_country_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[primary_service_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[primary_service_rcd]"
                      length="5"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[primary_service_rcd]"
                      name="primary_service_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[code]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[code]"
                      length="40"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[policy_code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[policy_code]"
                      length="40"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[policy_code]"
                      name="policy_code"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[patient_id]"
                      dataType="guid"
                      name="patient_id" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[patient_visit_id]"
                      dataType="guid"
                      name="patient_visit_id" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Visit Start]"
                      dataType="dbTimeStamp"
                      name="Visit Start" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Expected Discharge Date]"
                      dataType="dbTimeStamp"
                      name="Expected Discharge Date" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Closure Date]"
                      dataType="dbTimeStamp"
                      name="Closure Date" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[cancelled_date_time]"
                      dataType="dbTimeStamp"
                      name="cancelled_date_time" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Visit Type Name]"
                      dataType="wstr"
                      length="150"
                      name="Visit Type Name" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Visit Reason]"
                      dataType="wstr"
                      length="150"
                      name="Visit Reason" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Created By]"
                      dataType="wstr"
                      length="256"
                      name="Created By" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Place of Admission]"
                      dataType="wstr"
                      length="150"
                      name="Place of Admission" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Length of Stay]"
                      dataType="i4"
                      name="Length of Stay" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[policy_id]"
                      dataType="guid"
                      name="policy_id" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Visit Policies]"
                      dataType="wstr"
                      length="150"
                      name="Visit Policies" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[HN]"
                      codePage="1252"
                      dataType="str"
                      length="20"
                      name="HN" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Patient Name]"
                      dataType="wstr"
                      length="256"
                      name="Patient Name" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Region]"
                      dataType="wstr"
                      length="150"
                      name="Region" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Subregion]"
                      dataType="wstr"
                      length="150"
                      name="Subregion" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[City]"
                      dataType="wstr"
                      length="150"
                      name="City" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Address Type]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="Address Type" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Age]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="Age" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Date of Birth]"
                      dataType="dbTimeStamp"
                      name="Date of Birth" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Nationality]"
                      dataType="wstr"
                      length="150"
                      name="Nationality" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Race]"
                      dataType="wstr"
                      length="150"
                      name="Race" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Ethnic Group]"
                      dataType="nText"
                      name="Ethnic Group" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Religion]"
                      dataType="wstr"
                      length="150"
                      name="Religion" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Sex]"
                      dataType="wstr"
                      length="150"
                      name="Sex" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Home Country]"
                      dataType="wstr"
                      length="150"
                      name="Home Country" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Country of Residence]"
                      dataType="wstr"
                      length="150"
                      name="Country of Residence" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Home Address]"
                      dataType="wstr"
                      length="241"
                      name="Home Address" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Primary Service]"
                      dataType="wstr"
                      length="150"
                      name="Primary Service" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Ward]"
                      dataType="wstr"
                      length="150"
                      name="Ward" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Room Code]"
                      dataType="wstr"
                      length="20"
                      name="Room Code" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Room Class Name]"
                      dataType="wstr"
                      length="150"
                      name="Room Class Name" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Primary Doctor]"
                      dataType="wstr"
                      length="256"
                      name="Primary Doctor" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="diagnosis_type_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Diagnosis]"
                      dataType="nText"
                      name="Diagnosis" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Discharge Reason]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Reason" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Discharge Notes]"
                      dataType="wstr"
                      length="3000"
                      name="Discharge Notes" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Discharge Outcome]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Outcome" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[Discharge Disposition]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Disposition" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[visit_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      name="visit_type_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[nationality_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="nationality_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[ethnic_group_rcd_list]"
                      dataType="nText"
                      name="ethnic_group_rcd_list" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[religion_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="religion_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[sex_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="sex_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[home_address_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="home_address_country_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[residence_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="residence_country_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[primary_service_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="primary_service_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[code]"
                      codePage="1252"
                      dataType="str"
                      length="40"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].ExternalColumns[policy_code]"
                      dataType="wstr"
                      length="40"
                      name="policy_code" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[patient_id]"
                      dataType="guid"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[patient_id]"
                      name="patient_id" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[patient_visit_id]"
                      dataType="guid"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[patient_visit_id]"
                      name="patient_visit_id" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Visit Start]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Visit Start]"
                      name="Visit Start" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Expected Discharge Date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Expected Discharge Date]"
                      name="Expected Discharge Date" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Closure Date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Closure Date]"
                      name="Closure Date" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[cancelled_date_time]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[cancelled_date_time]"
                      name="cancelled_date_time" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Visit Type Name]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Visit Type Name]"
                      name="Visit Type Name" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Visit Reason]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Visit Reason]"
                      name="Visit Reason" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Created By]"
                      dataType="wstr"
                      length="256"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Created By]"
                      name="Created By" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Place of Admission]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Place of Admission]"
                      name="Place of Admission" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Length of Stay]"
                      dataType="i4"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Length of Stay]"
                      name="Length of Stay" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[policy_id]"
                      dataType="guid"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[policy_id]"
                      name="policy_id" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Visit Policies]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Visit Policies]"
                      name="Visit Policies" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[HN]"
                      codePage="1252"
                      dataType="str"
                      length="20"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[HN]"
                      name="HN" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Patient Name]"
                      dataType="wstr"
                      length="256"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Patient Name]"
                      name="Patient Name" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Region]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Region]"
                      name="Region" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Subregion]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Subregion]"
                      name="Subregion" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[City]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[City]"
                      name="City" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Address Type]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Address Type]"
                      name="Address Type" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Age]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Age]"
                      name="Age" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Date of Birth]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Date of Birth]"
                      name="Date of Birth" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Nationality]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Nationality]"
                      name="Nationality" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Race]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Race]"
                      name="Race" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Ethnic Group]"
                      dataType="nText"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Ethnic Group]"
                      name="Ethnic Group" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Religion]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Religion]"
                      name="Religion" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Sex]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Sex]"
                      name="Sex" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Home Country]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Home Country]"
                      name="Home Country" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Country of Residence]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Country of Residence]"
                      name="Country of Residence" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Home Address]"
                      dataType="wstr"
                      length="241"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Home Address]"
                      name="Home Address" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Primary Service]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Primary Service]"
                      name="Primary Service" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Ward]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Ward]"
                      name="Ward" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Room Code]"
                      dataType="wstr"
                      length="20"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Room Code]"
                      name="Room Code" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Room Class Name]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Room Class Name]"
                      name="Room Class Name" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Primary Doctor]"
                      dataType="wstr"
                      length="256"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Primary Doctor]"
                      name="Primary Doctor" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[diagnosis_type_rcd]"
                      name="diagnosis_type_rcd" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Diagnosis]"
                      dataType="nText"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Diagnosis]"
                      name="Diagnosis" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Discharge Reason]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Discharge Reason]"
                      name="Discharge Reason" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Discharge Notes]"
                      dataType="wstr"
                      length="3000"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Discharge Notes]"
                      name="Discharge Notes" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Discharge Outcome]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Discharge Outcome]"
                      name="Discharge Outcome" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Discharge Disposition]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[Discharge Disposition]"
                      name="Discharge Disposition" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[visit_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[visit_type_rcd]"
                      name="visit_type_rcd" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[nationality_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[nationality_rcd]"
                      name="nationality_rcd" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[ethnic_group_rcd_list]"
                      dataType="nText"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[ethnic_group_rcd_list]"
                      name="ethnic_group_rcd_list" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[religion_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[religion_rcd]"
                      name="religion_rcd" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[sex_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[sex_rcd]"
                      name="sex_rcd" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[home_address_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[home_address_country_rcd]"
                      name="home_address_country_rcd" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[residence_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[residence_country_rcd]"
                      name="residence_country_rcd" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[primary_service_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[primary_service_rcd]"
                      name="primary_service_rcd" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[code]"
                      codePage="1252"
                      dataType="str"
                      length="40"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[policy_code]"
                      dataType="wstr"
                      length="40"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[policy_code]"
                      name="policy_code" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Another stage table\Lookup"
              componentClassID="Microsoft.Lookup"
              contactInfo="Lookup;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;6"
              description="Joins additional columns to the data flow by looking up values in a table. For example, join to the 'employee id' column the employees table to get 'hire date' and 'employee name'. We recommend this transformation when the lookup table can fit into memory."
              name="Lookup"
              usesDispositions="true"
              version="6">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement that generates the lookup table."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">DECLARE @date1 DATETIME
DECLARE @date2 DATETIME

SET @date1 = '01/01/2018 00:00:00.000'
SET @date2 = SSIS.dbo.fn_TwoHRDateTo()
--select count(distinct tempc.patient_visit_id)

--from (

select tempb.patient_id
	   ,tempb.patient_visit_id
	   ,tempb.[Visit Start]
	   ,tempb.[Expected Discharge Date]
	   ,tempb.[Closure Date]
	   ,tempb.cancelled_date_time
	   ,tempb.visit_type_rcd
	   ,tempb.[Visit Type Name]
	   ,tempb.[Visit Reason]
	   ,tempb.[Created By]
	   ,tempb.[Place of Admission]
	   ,tempb.[Length of Stay]
	   ,tempb.[Visit Policies]
	   ,tempb.policy_id
	   ,tempb.policy_code
	   ,tempb.HN
	   ,tempb.[Patient Name]
	   ,tempb.Region
	   ,tempb.Subregion
	   ,tempb.City
	   ,tempb.[Address Type]
	   ,case when tempb.Age is null then (cast(cast((DATEDIFF(dd,tempb.[Date of Birth],GETDATE()) / 365.25) as int) as varchar)) else tempb.Age end as Age
	   ,tempb.[Date of Birth]
	   ,tempb.nationality_rcd
	   ,tempb.Nationality
	   ,tempb.Race
	   ,tempb.ethnic_group_rcd_list
	   ,tempb.[Ethnic Group]
	   ,tempb.religion_rcd
	   ,tempb.Religion
	   ,tempb.sex_rcd
	   ,tempb.Sex
	   ,tempb.home_address_country_rcd
	   ,tempb.[Home Country]
	   ,tempb.residence_country_rcd
	   ,tempb.[Country of Residence]
	   ,tempb.[Home Address]
	   ,tempb.primary_service_rcd
	   ,tempb.[Primary Service]
	   ,tempb.Ward
	   ,tempb.[Room Code]
	   ,tempb.[Room Class Name]
	   ,tempb.[Primary Doctor]
	   ,tempb.diagnosis_type_rcd
	   ,tempb.code
	   ,tempb.Diagnosis
	   ,tempb.[Discharge Reason]
	   ,tempb.[Discharge Notes]
	   ,tempb.[Discharge Outcome]
	   ,tempb.[Discharge Disposition]

from (

select temp.patient_id
	   ,temp.patient_visit_id
	   ,temp.[Visit Start]
	   ,temp.[Expected Discharge Date]
	   ,temp.[Closure Date]
	   ,temp.cancelled_date_time
	   ,temp.visit_type_rcd
	   ,temp.[Visit Type Name]
	   ,temp.[Visit Reason]
	   ,temp.[Created By]
	   ,temp.[Place of Admission]
	   ,temp.[Length of Stay]
	   ,temp.[Visit Policies]
	   ,temp.policy_id
	   ,temp.policy_code
	   ,temp.HN
	   ,temp.[Patient Name]
	   ,temp.Region
	   ,temp.Subregion
	   ,temp.City
	   ,temp.[Address Type]
	   ,temp.Age
	   ,temp.[Date of Birth]
	   ,temp.nationality_rcd
	   ,temp.Nationality
	   ,temp.Race
	   ,temp.ethnic_group_rcd_list
	   ,temp.[Ethnic Group]
	   ,temp.religion_rcd
	   ,temp.Religion
	   ,temp.sex_rcd
	   ,temp.Sex
	   ,temp.home_address_country_rcd
	   ,temp.[Home Country]
	   ,temp.residence_country_rcd
	   ,temp.[Country of Residence]
	   ,temp.[Home Address]
	   ,temp.primary_service_rcd
	   ,temp.[Primary Service]
	   ,temp.Ward
	   ,temp.[Room Code]
	   ,temp.[Room Class Name]
	   ,temp.[Primary Doctor]
	   ,pvdv.diagnosis_type_rcd
	   ,pvdv.coding_type_rcd
	   ,pvdv.active_flag
	   ,pvdv.primary_flag
	   ,pvdv.current_visit_diagnosis_flag
	   ,csed.coding_system_rcd
	   ,csed.code
       ,csed.description as Diagnosis
	   ,temp.[Discharge Reason]
	   ,temp.[Discharge Notes]
	   ,temp.[Discharge Outcome]
	   ,temp.[Discharge Disposition]

from (

select distinct apv.patient_id
	   ,api.patient_visit_id
	   ,api.actual_visit_date_time as [Visit Start]
	   ,api.expected_discharge_date_time as [Expected Discharge Date]
	   ,api.closure_date_time as [Closure Date]
	   ,api.cancelled_date_time
	   ,api.visit_type_rcd
	   ,api.visit_type_name_l as [Visit Type Name]
	   --,stuff((select '; ' + name_l from patient_visit_reason a1 left join visit_reason_ref a2 on a1.visit_reason_rcd = a2.visit_reason_rcd
				--														where a1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Reason]
	   ,vrr.name_l as [Visit Reason]
	   ,emp1.display_name_l as [Created By]
	   ,api.created_from_area_name_l as [Place of Admission]
	   ,datediff(dd,api.actual_visit_date_time,api.closure_date_time) as [Length of Stay]
	   --,stuff((select '; ' + b1.policy_name_l from api_patient_visit_policy_view b1 where b1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Policies]
	   ,ISNULL(apvp.policy_name_l, 'Self Pay') as [Visit Policies]
	   ,apvp.policy_id
	   ,apvp.policy_code
	   ,apv.visible_patient_id as HN
	   ,apv.display_name_l as [Patient Name]
	   ,case when ADNV.city is NULL then city.city_id else ADNV.city_id end as city_id
	   ,case when ADNV.city is NULL then city.name_l else ADNV.city end as City
	   ,case when adnv.city_id is NOT NULL then  (SELECT region_id
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT region_id								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as region_id
	   ,case when adnv.city_id is NOT NULL then  (SELECT name_l
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT name_l								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as Region
	    ,case when adnv.city_id is not NULL then (SELECT subr.subregion_id as subregion
															from AmalgaPROD.dbo.subregion_nl_view subr
															where subr.subregion_id = city.subregion_id) else (SELECT subr.subregion_id as subregion
																												from AmalgaPROD.dbo.subregion_nl_view subr
																												where subr.subregion_id = adnv.subregion_id) end as subregion_id
		,case when adnv.city_id is not NULL then (SELECT subr.name_l as subregion
													from AmalgaPROD.dbo.subregion_nl_view subr
													where subr.subregion_id = adnv.subregion_id) else (SELECT subr.name_l as subregion
																										from AmalgaPROD.dbo.subregion_nl_view subr
																										where subr.subregion_id = adnv.subregion_id) end as Subregion
		,case when panv.person_address_type_rcd is NULL then 'N/A' ELSE panv.person_address_type_rcd end as [Address Type]
		--,datediff(dd,apv.date_of_birth, getdate()) / 365 as Age
		,cast(cast((DATEDIFF(dd,apv.date_of_birth,api.closure_date_time) / 365.25) as int) as varchar) as Age
		,apv.date_of_birth as [Date of Birth]
		,apv.nationality_rcd
		,apv.nationality_name_l as Nationality
		,apv.race_name_l as Race
		,case when apv.ethnic_group_rcd_list is null then 'UNK' else apv.ethnic_group_rcd_list end as ethnic_group_rcd_list
		,case when apv.ethnic_group_name_l_list is null then 'Unknown' else apv.ethnic_group_name_l_list end as [Ethnic Group]
		,apv.religion_rcd
		,apv.religion_name_l as Religion
		,apv.sex_rcd
		,apv.sex_name_l as Sex
		,case when apv.home_address_country_rcd is null then 'UNK' else apv.home_address_country_rcd end as home_address_country_rcd
		,case when apv.home_address_country_name_l is null then 'Unknown' else apv.home_address_country_name_l end as [Home Country]
		,apv.residence_country_rcd
		,apv.residence_country_name_l as [Country of Residence]
		,ISNULL(apv.home_address_line_1_l,'') + ' ' + ISNULL(apv.home_address_line_2_l,'') + ISNULL(apv.home_address_line_3_l,'') as [Home Address]
		,api.primary_service_rcd
		,api.primary_service_name_l as [Primary Service]
		,(select top 1 ward_name_l from bed_entry_info_view t1 
					where t1.patient_visit_id = api.patient_visit_id
					order by start_date_time desc) as Ward
	    ,api.admission_bed_code as [Room Code]
		,api.admission_room_charge_set_name_l as [Room Class Name]
		,[Primary Doctor] = (Select top 1 display_name_l from person_formatted_name_iview pfn 
		                            left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
		                            where cr.employee_id = pfn.person_id
									      and cr.caregiver_role_type_rcd = 'PRIDR'
		                                  and cr.caregiver_role_status_rcd = 'ACTIV'
										  and cr.inactivated_date_time is null
										  order by cr.lu_updated desc)
		,api.discharge_reason_name_l as [Discharge Reason]
		,api.discharge_notes as [Discharge Notes]
		,api.discharge_outcome_name_l as [Discharge Outcome]
		,api.discharge_disposition_name_l as [Discharge Disposition]

FROM api_patient_visit_view api 
			left join api_patient_view apv on api.patient_id = apv.patient_id
			left join user_account ua on api.created_by = ua.user_id
			left join person_formatted_name_iview emp1 on ua.person_id = emp1.person_id
			left join api_patient_visit_policy_view apvp on api.patient_visit_id = apvp.patient_visit_id
			left join address_label_view al on apv.home_address_id = al.address_id
			left join person_address_nl_view panv ON apv.patient_id = panv.person_id
			left join address_nl_view adnv ON al.address_id = adnv.address_id
			left join city_nl_view city on ADNV.city_id = city.city_id
			--left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
			--left join person_formatted_name_iview emp2 on emp2.person_id = cr.employee_id
			left join patient_visit_reason pvr on api.patient_visit_id = pvr.patient_visit_id
			left join visit_reason_ref vrr on pvr.visit_reason_rcd = vrr.visit_reason_rcd
			--left join country_ref cref on apv.home_address_country_rcd = cref.country_rcd


where api.visit_type_rcd in ('V1', 'V2')

) as temp
			left join patient_visit_diagnosis_view pvdv on pvdv.patient_visit_id = temp.patient_visit_id
			left join coding_system_element_description csed on csed.code = pvdv.code

where temp.[Address Type] in ('H1','N/A')
	  and (csed.coding_system_rcd is null or csed.coding_system_rcd in ('ICD10', 'ICD9CM'))
	  --and (pvdv.coding_type_rcd is null or pvdv.coding_type_rcd = 'PRI')
	  and isnull(pvdv.current_visit_diagnosis_flag,0) = 1
      and (select count(*) from patient_visit_diagnosis_view
				where patient_visit_id = pvdv.patient_visit_id
				and current_visit_diagnosis_flag = 1) &gt; 0

UNION ALL

select temp.patient_id
	   ,temp.patient_visit_id
	   ,temp.[Visit Start]
	   ,temp.[Expected Discharge Date]
	   ,temp.[Closure Date]
	   ,temp.cancelled_date_time
	   ,temp.visit_type_rcd
	   ,temp.[Visit Type Name]
	   ,temp.[Visit Reason]
	   ,temp.[Created By]
	   ,temp.[Place of Admission]
	   ,temp.[Length of Stay]
	   ,temp.[Visit Policies]
	   ,temp.policy_id
	   ,temp.policy_code
	   ,temp.HN
	   ,temp.[Patient Name]
	   ,temp.Region
	   ,temp.Subregion
	   ,temp.City
	   ,temp.[Address Type]
	   ,temp.Age
	   ,temp.[Date of Birth]
	   ,temp.nationality_rcd
	   ,temp.Nationality
	   ,temp.Race
	   ,temp.ethnic_group_rcd_list
	   ,temp.[Ethnic Group]
	   ,temp.religion_rcd
	   ,temp.Religion
	   ,temp.sex_rcd
	   ,temp.Sex
	   ,temp.home_address_country_rcd
	   ,temp.[Home Country]
	   ,temp.residence_country_rcd
	   ,temp.[Country of Residence]
	   ,temp.[Home Address]
	   ,temp.primary_service_rcd
	   ,temp.[Primary Service]
	   ,temp.Ward
	   ,temp.[Room Code]
	   ,temp.[Room Class Name]
	   ,temp.[Primary Doctor]
	   ,pvdv.diagnosis_type_rcd
	   ,pvdv.coding_type_rcd
	   ,pvdv.active_flag
	   ,pvdv.primary_flag
	   ,pvdv.current_visit_diagnosis_flag
	   ,csed.coding_system_rcd
	   ,csed.code
       ,csed.description as Diagnosis
	   ,temp.[Discharge Reason]
	   ,temp.[Discharge Notes]
	   ,temp.[Discharge Outcome]
	   ,temp.[Discharge Disposition]

from (

select distinct apv.patient_id
	   ,api.patient_visit_id
	   ,api.actual_visit_date_time as [Visit Start]
	   ,api.expected_discharge_date_time as [Expected Discharge Date]
	   ,api.closure_date_time as [Closure Date]
	   ,api.cancelled_date_time
	   ,api.visit_type_rcd
	   ,api.visit_type_name_l as [Visit Type Name]
	   --,stuff((select '; ' + name_l from patient_visit_reason a1 left join visit_reason_ref a2 on a1.visit_reason_rcd = a2.visit_reason_rcd
				--														where a1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Reason]
	   ,vrr.name_l as [Visit Reason]
	   ,emp1.display_name_l as [Created By]
	   ,api.created_from_area_name_l as [Place of Admission]
	   ,datediff(dd,api.actual_visit_date_time,api.closure_date_time) as [Length of Stay]
	   --,stuff((select '; ' + b1.policy_name_l from api_patient_visit_policy_view b1 where b1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Policies]
	   ,ISNULL(apvp.policy_name_l, 'Self Pay') as [Visit Policies]
	   ,apvp.policy_id
	   ,apvp.policy_code
	   ,apv.visible_patient_id as HN
	   ,apv.display_name_l as [Patient Name]
	   ,case when ADNV.city is NULL then city.city_id else ADNV.city_id end as city_id
	   ,case when ADNV.city is NULL then city.name_l else ADNV.city end as City
	   ,case when adnv.city_id is NOT NULL then  (SELECT region_id
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT region_id								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as region_id
	   ,case when adnv.city_id is NOT NULL then  (SELECT name_l
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT name_l								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as Region
	    ,case when adnv.city_id is not NULL then (SELECT subr.subregion_id as subregion
															from AmalgaPROD.dbo.subregion_nl_view subr
															where subr.subregion_id = city.subregion_id) else (SELECT subr.subregion_id as subregion
																												from AmalgaPROD.dbo.subregion_nl_view subr
																												where subr.subregion_id = adnv.subregion_id) end as subregion_id
		,case when adnv.city_id is not NULL then (SELECT subr.name_l as subregion
													from AmalgaPROD.dbo.subregion_nl_view subr
													where subr.subregion_id = adnv.subregion_id) else (SELECT subr.name_l as subregion
																										from AmalgaPROD.dbo.subregion_nl_view subr
																										where subr.subregion_id = adnv.subregion_id) end as Subregion
		,case when panv.person_address_type_rcd is NULL then 'N/A' ELSE panv.person_address_type_rcd end as [Address Type]
		--,datediff(dd,apv.date_of_birth, getdate()) / 365 as Age
		,cast(cast((DATEDIFF(dd,apv.date_of_birth,api.closure_date_time) / 365.25) as int) as varchar) as Age
		,apv.date_of_birth as [Date of Birth]
		,apv.nationality_rcd
		,apv.nationality_name_l as Nationality
		,apv.race_name_l as Race
		,case when apv.ethnic_group_rcd_list is null then 'UNK' else apv.ethnic_group_rcd_list end as ethnic_group_rcd_list
		,case when apv.ethnic_group_name_l_list is null then 'Unknown' else apv.ethnic_group_name_l_list end as [Ethnic Group]
		,apv.religion_rcd
		,apv.religion_name_l as Religion
		,apv.sex_rcd
		,apv.sex_name_l as Sex
		,case when apv.home_address_country_rcd is null then 'UNK' else apv.home_address_country_rcd end as home_address_country_rcd
		,case when apv.home_address_country_name_l is null then 'Unknown' else apv.home_address_country_name_l end as [Home Country]
		,apv.residence_country_rcd
		,apv.residence_country_name_l as [Country of Residence]
		,ISNULL(apv.home_address_line_1_l,'') + ' ' + ISNULL(apv.home_address_line_2_l,'') + ISNULL(apv.home_address_line_3_l,'') as [Home Address]
		,api.primary_service_rcd
		,api.primary_service_name_l as [Primary Service]
		,(select top 1 ward_name_l from bed_entry_info_view t1 
					where t1.patient_visit_id = api.patient_visit_id
					order by start_date_time desc) as Ward
	    ,api.admission_bed_code as [Room Code]
		,api.admission_room_charge_set_name_l as [Room Class Name]
		,[Primary Doctor] = (Select top 1 display_name_l from person_formatted_name_iview pfn 
		                            left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
		                            where cr.employee_id = pfn.person_id
									      and cr.caregiver_role_type_rcd = 'PRIDR'
		                                  and cr.caregiver_role_status_rcd = 'ACTIV'
										  and cr.inactivated_date_time is null
										  order by cr.lu_updated desc)
		,api.discharge_reason_name_l as [Discharge Reason]
		,api.discharge_notes as [Discharge Notes]
		,api.discharge_outcome_name_l as [Discharge Outcome]
		,api.discharge_disposition_name_l as [Discharge Disposition]

FROM api_patient_visit_view api 
			left join api_patient_view apv on api.patient_id = apv.patient_id
			left join user_account ua on api.created_by = ua.user_id
			left join person_formatted_name_iview emp1 on ua.person_id = emp1.person_id
			left join api_patient_visit_policy_view apvp on api.patient_visit_id = apvp.patient_visit_id
			left join address_label_view al on apv.home_address_id = al.address_id
			left join person_address_nl_view panv ON apv.patient_id = panv.person_id
			left join address_nl_view adnv ON al.address_id = adnv.address_id
			left join city_nl_view city on ADNV.city_id = city.city_id
			--left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
			--left join person_formatted_name_iview emp2 on emp2.person_id = cr.employee_id
			left join patient_visit_reason pvr on api.patient_visit_id = pvr.patient_visit_id
			left join visit_reason_ref vrr on pvr.visit_reason_rcd = vrr.visit_reason_rcd
			--left join country_ref cref on apv.home_address_country_rcd = cref.country_rcd

where api.visit_type_rcd in ('V1', 'V2')

) as temp
			left join patient_visit_diagnosis_view pvdv on temp.patient_visit_id = pvdv.patient_visit_id
			left join coding_system_element_description csed on pvdv.code = csed.code

where temp.[Address Type] in ('H1','N/A')
	  and (csed.coding_system_rcd is null or csed.coding_system_rcd in ('ICD10', 'ICD9CM'))
	  and (pvdv.coding_type_rcd is null or pvdv.coding_type_rcd = 'PRI')
      and (select count(*) from patient_visit_diagnosis_view
				where patient_visit_id = pvdv.patient_visit_id
				and current_visit_diagnosis_flag = 1) = 0

) as tempb
where tempb.[Visit Start] between @date1 and @date2
	  
--) as tempc</property>
                <property
                  dataType="System.String"
                  description="Specifies a SQL statement that uses parameters to generate the lookup table."
                  expressionType="Notify"
                  name="SqlCommandParam"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">select * from (DECLARE @date1 DATETIME
DECLARE @date2 DATETIME

SET @date1 = '01/01/2018 00:00:00.000'
SET @date2 = SSIS.dbo.fn_TwoHRDateTo()
--select count(distinct tempc.patient_visit_id)

--from (

select tempb.patient_id
	   ,tempb.patient_visit_id
	   ,tempb.[Visit Start]
	   ,tempb.[Expected Discharge Date]
	   ,tempb.[Closure Date]
	   ,tempb.cancelled_date_time
	   ,tempb.visit_type_rcd
	   ,tempb.[Visit Type Name]
	   ,tempb.[Visit Reason]
	   ,tempb.[Created By]
	   ,tempb.[Place of Admission]
	   ,tempb.[Length of Stay]
	   ,tempb.[Visit Policies]
	   ,tempb.policy_id
	   ,tempb.policy_code
	   ,tempb.HN
	   ,tempb.[Patient Name]
	   ,tempb.Region
	   ,tempb.Subregion
	   ,tempb.City
	   ,tempb.[Address Type]
	   ,case when tempb.Age is null then (cast(cast((DATEDIFF(dd,tempb.[Date of Birth],GETDATE()) / 365.25) as int) as varchar)) else tempb.Age end as Age
	   ,tempb.[Date of Birth]
	   ,tempb.nationality_rcd
	   ,tempb.Nationality
	   ,tempb.Race
	   ,tempb.ethnic_group_rcd_list
	   ,tempb.[Ethnic Group]
	   ,tempb.religion_rcd
	   ,tempb.Religion
	   ,tempb.sex_rcd
	   ,tempb.Sex
	   ,tempb.home_address_country_rcd
	   ,tempb.[Home Country]
	   ,tempb.residence_country_rcd
	   ,tempb.[Country of Residence]
	   ,tempb.[Home Address]
	   ,tempb.primary_service_rcd
	   ,tempb.[Primary Service]
	   ,tempb.Ward
	   ,tempb.[Room Code]
	   ,tempb.[Room Class Name]
	   ,tempb.[Primary Doctor]
	   ,tempb.diagnosis_type_rcd
	   ,tempb.code
	   ,tempb.Diagnosis
	   ,tempb.[Discharge Reason]
	   ,tempb.[Discharge Notes]
	   ,tempb.[Discharge Outcome]
	   ,tempb.[Discharge Disposition]

from (

select temp.patient_id
	   ,temp.patient_visit_id
	   ,temp.[Visit Start]
	   ,temp.[Expected Discharge Date]
	   ,temp.[Closure Date]
	   ,temp.cancelled_date_time
	   ,temp.visit_type_rcd
	   ,temp.[Visit Type Name]
	   ,temp.[Visit Reason]
	   ,temp.[Created By]
	   ,temp.[Place of Admission]
	   ,temp.[Length of Stay]
	   ,temp.[Visit Policies]
	   ,temp.policy_id
	   ,temp.policy_code
	   ,temp.HN
	   ,temp.[Patient Name]
	   ,temp.Region
	   ,temp.Subregion
	   ,temp.City
	   ,temp.[Address Type]
	   ,temp.Age
	   ,temp.[Date of Birth]
	   ,temp.nationality_rcd
	   ,temp.Nationality
	   ,temp.Race
	   ,temp.ethnic_group_rcd_list
	   ,temp.[Ethnic Group]
	   ,temp.religion_rcd
	   ,temp.Religion
	   ,temp.sex_rcd
	   ,temp.Sex
	   ,temp.home_address_country_rcd
	   ,temp.[Home Country]
	   ,temp.residence_country_rcd
	   ,temp.[Country of Residence]
	   ,temp.[Home Address]
	   ,temp.primary_service_rcd
	   ,temp.[Primary Service]
	   ,temp.Ward
	   ,temp.[Room Code]
	   ,temp.[Room Class Name]
	   ,temp.[Primary Doctor]
	   ,pvdv.diagnosis_type_rcd
	   ,pvdv.coding_type_rcd
	   ,pvdv.active_flag
	   ,pvdv.primary_flag
	   ,pvdv.current_visit_diagnosis_flag
	   ,csed.coding_system_rcd
	   ,csed.code
       ,csed.description as Diagnosis
	   ,temp.[Discharge Reason]
	   ,temp.[Discharge Notes]
	   ,temp.[Discharge Outcome]
	   ,temp.[Discharge Disposition]

from (

select distinct apv.patient_id
	   ,api.patient_visit_id
	   ,api.actual_visit_date_time as [Visit Start]
	   ,api.expected_discharge_date_time as [Expected Discharge Date]
	   ,api.closure_date_time as [Closure Date]
	   ,api.cancelled_date_time
	   ,api.visit_type_rcd
	   ,api.visit_type_name_l as [Visit Type Name]
	   --,stuff((select '; ' + name_l from patient_visit_reason a1 left join visit_reason_ref a2 on a1.visit_reason_rcd = a2.visit_reason_rcd
				--														where a1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Reason]
	   ,vrr.name_l as [Visit Reason]
	   ,emp1.display_name_l as [Created By]
	   ,api.created_from_area_name_l as [Place of Admission]
	   ,datediff(dd,api.actual_visit_date_time,api.closure_date_time) as [Length of Stay]
	   --,stuff((select '; ' + b1.policy_name_l from api_patient_visit_policy_view b1 where b1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Policies]
	   ,ISNULL(apvp.policy_name_l, 'Self Pay') as [Visit Policies]
	   ,apvp.policy_id
	   ,apvp.policy_code
	   ,apv.visible_patient_id as HN
	   ,apv.display_name_l as [Patient Name]
	   ,case when ADNV.city is NULL then city.city_id else ADNV.city_id end as city_id
	   ,case when ADNV.city is NULL then city.name_l else ADNV.city end as City
	   ,case when adnv.city_id is NOT NULL then  (SELECT region_id
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT region_id								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as region_id
	   ,case when adnv.city_id is NOT NULL then  (SELECT name_l
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT name_l								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as Region
	    ,case when adnv.city_id is not NULL then (SELECT subr.subregion_id as subregion
															from AmalgaPROD.dbo.subregion_nl_view subr
															where subr.subregion_id = city.subregion_id) else (SELECT subr.subregion_id as subregion
																												from AmalgaPROD.dbo.subregion_nl_view subr
																												where subr.subregion_id = adnv.subregion_id) end as subregion_id
		,case when adnv.city_id is not NULL then (SELECT subr.name_l as subregion
													from AmalgaPROD.dbo.subregion_nl_view subr
													where subr.subregion_id = adnv.subregion_id) else (SELECT subr.name_l as subregion
																										from AmalgaPROD.dbo.subregion_nl_view subr
																										where subr.subregion_id = adnv.subregion_id) end as Subregion
		,case when panv.person_address_type_rcd is NULL then 'N/A' ELSE panv.person_address_type_rcd end as [Address Type]
		--,datediff(dd,apv.date_of_birth, getdate()) / 365 as Age
		,cast(cast((DATEDIFF(dd,apv.date_of_birth,api.closure_date_time) / 365.25) as int) as varchar) as Age
		,apv.date_of_birth as [Date of Birth]
		,apv.nationality_rcd
		,apv.nationality_name_l as Nationality
		,apv.race_name_l as Race
		,case when apv.ethnic_group_rcd_list is null then 'UNK' else apv.ethnic_group_rcd_list end as ethnic_group_rcd_list
		,case when apv.ethnic_group_name_l_list is null then 'Unknown' else apv.ethnic_group_name_l_list end as [Ethnic Group]
		,apv.religion_rcd
		,apv.religion_name_l as Religion
		,apv.sex_rcd
		,apv.sex_name_l as Sex
		,case when apv.home_address_country_rcd is null then 'UNK' else apv.home_address_country_rcd end as home_address_country_rcd
		,case when apv.home_address_country_name_l is null then 'Unknown' else apv.home_address_country_name_l end as [Home Country]
		,apv.residence_country_rcd
		,apv.residence_country_name_l as [Country of Residence]
		,ISNULL(apv.home_address_line_1_l,'') + ' ' + ISNULL(apv.home_address_line_2_l,'') + ISNULL(apv.home_address_line_3_l,'') as [Home Address]
		,api.primary_service_rcd
		,api.primary_service_name_l as [Primary Service]
		,(select top 1 ward_name_l from bed_entry_info_view t1 
					where t1.patient_visit_id = api.patient_visit_id
					order by start_date_time desc) as Ward
	    ,api.admission_bed_code as [Room Code]
		,api.admission_room_charge_set_name_l as [Room Class Name]
		,[Primary Doctor] = (Select top 1 display_name_l from person_formatted_name_iview pfn 
		                            left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
		                            where cr.employee_id = pfn.person_id
									      and cr.caregiver_role_type_rcd = 'PRIDR'
		                                  and cr.caregiver_role_status_rcd = 'ACTIV'
										  and cr.inactivated_date_time is null
										  order by cr.lu_updated desc)
		,api.discharge_reason_name_l as [Discharge Reason]
		,api.discharge_notes as [Discharge Notes]
		,api.discharge_outcome_name_l as [Discharge Outcome]
		,api.discharge_disposition_name_l as [Discharge Disposition]

FROM api_patient_visit_view api 
			left join api_patient_view apv on api.patient_id = apv.patient_id
			left join user_account ua on api.created_by = ua.user_id
			left join person_formatted_name_iview emp1 on ua.person_id = emp1.person_id
			left join api_patient_visit_policy_view apvp on api.patient_visit_id = apvp.patient_visit_id
			left join address_label_view al on apv.home_address_id = al.address_id
			left join person_address_nl_view panv ON apv.patient_id = panv.person_id
			left join address_nl_view adnv ON al.address_id = adnv.address_id
			left join city_nl_view city on ADNV.city_id = city.city_id
			--left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
			--left join person_formatted_name_iview emp2 on emp2.person_id = cr.employee_id
			left join patient_visit_reason pvr on api.patient_visit_id = pvr.patient_visit_id
			left join visit_reason_ref vrr on pvr.visit_reason_rcd = vrr.visit_reason_rcd
			--left join country_ref cref on apv.home_address_country_rcd = cref.country_rcd


where api.visit_type_rcd in ('V1', 'V2')

) as temp
			left join patient_visit_diagnosis_view pvdv on pvdv.patient_visit_id = temp.patient_visit_id
			left join coding_system_element_description csed on csed.code = pvdv.code

where temp.[Address Type] in ('H1','N/A')
	  and (csed.coding_system_rcd is null or csed.coding_system_rcd in ('ICD10', 'ICD9CM'))
	  --and (pvdv.coding_type_rcd is null or pvdv.coding_type_rcd = 'PRI')
	  and isnull(pvdv.current_visit_diagnosis_flag,0) = 1
      and (select count(*) from patient_visit_diagnosis_view
				where patient_visit_id = pvdv.patient_visit_id
				and current_visit_diagnosis_flag = 1) &gt; 0

UNION ALL

select temp.patient_id
	   ,temp.patient_visit_id
	   ,temp.[Visit Start]
	   ,temp.[Expected Discharge Date]
	   ,temp.[Closure Date]
	   ,temp.cancelled_date_time
	   ,temp.visit_type_rcd
	   ,temp.[Visit Type Name]
	   ,temp.[Visit Reason]
	   ,temp.[Created By]
	   ,temp.[Place of Admission]
	   ,temp.[Length of Stay]
	   ,temp.[Visit Policies]
	   ,temp.policy_id
	   ,temp.policy_code
	   ,temp.HN
	   ,temp.[Patient Name]
	   ,temp.Region
	   ,temp.Subregion
	   ,temp.City
	   ,temp.[Address Type]
	   ,temp.Age
	   ,temp.[Date of Birth]
	   ,temp.nationality_rcd
	   ,temp.Nationality
	   ,temp.Race
	   ,temp.ethnic_group_rcd_list
	   ,temp.[Ethnic Group]
	   ,temp.religion_rcd
	   ,temp.Religion
	   ,temp.sex_rcd
	   ,temp.Sex
	   ,temp.home_address_country_rcd
	   ,temp.[Home Country]
	   ,temp.residence_country_rcd
	   ,temp.[Country of Residence]
	   ,temp.[Home Address]
	   ,temp.primary_service_rcd
	   ,temp.[Primary Service]
	   ,temp.Ward
	   ,temp.[Room Code]
	   ,temp.[Room Class Name]
	   ,temp.[Primary Doctor]
	   ,pvdv.diagnosis_type_rcd
	   ,pvdv.coding_type_rcd
	   ,pvdv.active_flag
	   ,pvdv.primary_flag
	   ,pvdv.current_visit_diagnosis_flag
	   ,csed.coding_system_rcd
	   ,csed.code
       ,csed.description as Diagnosis
	   ,temp.[Discharge Reason]
	   ,temp.[Discharge Notes]
	   ,temp.[Discharge Outcome]
	   ,temp.[Discharge Disposition]

from (

select distinct apv.patient_id
	   ,api.patient_visit_id
	   ,api.actual_visit_date_time as [Visit Start]
	   ,api.expected_discharge_date_time as [Expected Discharge Date]
	   ,api.closure_date_time as [Closure Date]
	   ,api.cancelled_date_time
	   ,api.visit_type_rcd
	   ,api.visit_type_name_l as [Visit Type Name]
	   --,stuff((select '; ' + name_l from patient_visit_reason a1 left join visit_reason_ref a2 on a1.visit_reason_rcd = a2.visit_reason_rcd
				--														where a1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Reason]
	   ,vrr.name_l as [Visit Reason]
	   ,emp1.display_name_l as [Created By]
	   ,api.created_from_area_name_l as [Place of Admission]
	   ,datediff(dd,api.actual_visit_date_time,api.closure_date_time) as [Length of Stay]
	   --,stuff((select '; ' + b1.policy_name_l from api_patient_visit_policy_view b1 where b1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Policies]
	   ,ISNULL(apvp.policy_name_l, 'Self Pay') as [Visit Policies]
	   ,apvp.policy_id
	   ,apvp.policy_code
	   ,apv.visible_patient_id as HN
	   ,apv.display_name_l as [Patient Name]
	   ,case when ADNV.city is NULL then city.city_id else ADNV.city_id end as city_id
	   ,case when ADNV.city is NULL then city.name_l else ADNV.city end as City
	   ,case when adnv.city_id is NOT NULL then  (SELECT region_id
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT region_id								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as region_id
	   ,case when adnv.city_id is NOT NULL then  (SELECT name_l
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT name_l								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as Region
	    ,case when adnv.city_id is not NULL then (SELECT subr.subregion_id as subregion
															from AmalgaPROD.dbo.subregion_nl_view subr
															where subr.subregion_id = city.subregion_id) else (SELECT subr.subregion_id as subregion
																												from AmalgaPROD.dbo.subregion_nl_view subr
																												where subr.subregion_id = adnv.subregion_id) end as subregion_id
		,case when adnv.city_id is not NULL then (SELECT subr.name_l as subregion
													from AmalgaPROD.dbo.subregion_nl_view subr
													where subr.subregion_id = adnv.subregion_id) else (SELECT subr.name_l as subregion
																										from AmalgaPROD.dbo.subregion_nl_view subr
																										where subr.subregion_id = adnv.subregion_id) end as Subregion
		,case when panv.person_address_type_rcd is NULL then 'N/A' ELSE panv.person_address_type_rcd end as [Address Type]
		--,datediff(dd,apv.date_of_birth, getdate()) / 365 as Age
		,cast(cast((DATEDIFF(dd,apv.date_of_birth,api.closure_date_time) / 365.25) as int) as varchar) as Age
		,apv.date_of_birth as [Date of Birth]
		,apv.nationality_rcd
		,apv.nationality_name_l as Nationality
		,apv.race_name_l as Race
		,case when apv.ethnic_group_rcd_list is null then 'UNK' else apv.ethnic_group_rcd_list end as ethnic_group_rcd_list
		,case when apv.ethnic_group_name_l_list is null then 'Unknown' else apv.ethnic_group_name_l_list end as [Ethnic Group]
		,apv.religion_rcd
		,apv.religion_name_l as Religion
		,apv.sex_rcd
		,apv.sex_name_l as Sex
		,case when apv.home_address_country_rcd is null then 'UNK' else apv.home_address_country_rcd end as home_address_country_rcd
		,case when apv.home_address_country_name_l is null then 'Unknown' else apv.home_address_country_name_l end as [Home Country]
		,apv.residence_country_rcd
		,apv.residence_country_name_l as [Country of Residence]
		,ISNULL(apv.home_address_line_1_l,'') + ' ' + ISNULL(apv.home_address_line_2_l,'') + ISNULL(apv.home_address_line_3_l,'') as [Home Address]
		,api.primary_service_rcd
		,api.primary_service_name_l as [Primary Service]
		,(select top 1 ward_name_l from bed_entry_info_view t1 
					where t1.patient_visit_id = api.patient_visit_id
					order by start_date_time desc) as Ward
	    ,api.admission_bed_code as [Room Code]
		,api.admission_room_charge_set_name_l as [Room Class Name]
		,[Primary Doctor] = (Select top 1 display_name_l from person_formatted_name_iview pfn 
		                            left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
		                            where cr.employee_id = pfn.person_id
									      and cr.caregiver_role_type_rcd = 'PRIDR'
		                                  and cr.caregiver_role_status_rcd = 'ACTIV'
										  and cr.inactivated_date_time is null
										  order by cr.lu_updated desc)
		,api.discharge_reason_name_l as [Discharge Reason]
		,api.discharge_notes as [Discharge Notes]
		,api.discharge_outcome_name_l as [Discharge Outcome]
		,api.discharge_disposition_name_l as [Discharge Disposition]

FROM api_patient_visit_view api 
			left join api_patient_view apv on api.patient_id = apv.patient_id
			left join user_account ua on api.created_by = ua.user_id
			left join person_formatted_name_iview emp1 on ua.person_id = emp1.person_id
			left join api_patient_visit_policy_view apvp on api.patient_visit_id = apvp.patient_visit_id
			left join address_label_view al on apv.home_address_id = al.address_id
			left join person_address_nl_view panv ON apv.patient_id = panv.person_id
			left join address_nl_view adnv ON al.address_id = adnv.address_id
			left join city_nl_view city on ADNV.city_id = city.city_id
			--left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
			--left join person_formatted_name_iview emp2 on emp2.person_id = cr.employee_id
			left join patient_visit_reason pvr on api.patient_visit_id = pvr.patient_visit_id
			left join visit_reason_ref vrr on pvr.visit_reason_rcd = vrr.visit_reason_rcd
			--left join country_ref cref on apv.home_address_country_rcd = cref.country_rcd

where api.visit_type_rcd in ('V1', 'V2')

) as temp
			left join patient_visit_diagnosis_view pvdv on temp.patient_visit_id = pvdv.patient_visit_id
			left join coding_system_element_description csed on pvdv.code = csed.code

where temp.[Address Type] in ('H1','N/A')
	  and (csed.coding_system_rcd is null or csed.coding_system_rcd in ('ICD10', 'ICD9CM'))
	  and (pvdv.coding_type_rcd is null or pvdv.coding_type_rcd = 'PRI')
      and (select count(*) from patient_visit_diagnosis_view
				where patient_visit_id = pvdv.patient_visit_id
				and current_visit_diagnosis_flag = 1) = 0

) as tempb
where tempb.[Visit Start] between @date1 and @date2
	  
--) as tempc) [refTable]
where [refTable].[patient_id] = ? and [refTable].[patient_visit_id] = ? and [refTable].[policy_id] = ?</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the type of connection used to access the reference dataset."
                  name="ConnectionType"
                  typeConverter="LookupConnectionType">0</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the cache type of the lookup table."
                  name="CacheType"
                  typeConverter="CacheType">0</property>
                <property
                  dataType="System.Int32"
                  description="Specifies how the Lookup transformation handles rows without matching entries in the reference data set."
                  name="NoMatchBehavior"
                  typeConverter="LookupNoMatchBehavior">1</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the percentage of the cache that is allocated for rows with no matching entries in the reference dataset."
                  name="NoMatchCachePercentage">0</property>
                <property
                  dataType="System.Int32"
                  description="Maximum Memory Usage for Reference Cache on a 32 bit platform."
                  name="MaxMemoryUsage">25</property>
                <property
                  dataType="System.Int64"
                  description="Maximum Memory Usage for Reference Cache on a 64 bit platform."
                  name="MaxMemoryUsage64">25</property>
                <property
                  dataType="System.String"
                  description="Indicates whether to reference metadata in an XML format."
                  name="ReferenceMetadataXml">&lt;referenceMetadata&gt;&lt;referenceColumns&gt;&lt;referenceColumn name="patient_id" dataType="DT_GUID" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="patient_visit_id" dataType="DT_GUID" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Visit Start" dataType="DT_DBTIMESTAMP" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Expected Discharge Date" dataType="DT_DBTIMESTAMP" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Closure Date" dataType="DT_DBTIMESTAMP" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="cancelled_date_time" dataType="DT_DBTIMESTAMP" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="visit_type_rcd" dataType="DT_STR" length="6" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Visit Type Name" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Visit Reason" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Created By" dataType="DT_WSTR" length="256" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Place of Admission" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Length of Stay" dataType="DT_I4" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Visit Policies" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="policy_id" dataType="DT_GUID" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="policy_code" dataType="DT_WSTR" length="40" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="HN" dataType="DT_STR" length="20" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Patient Name" dataType="DT_WSTR" length="256" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Region" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Subregion" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="City" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Address Type" dataType="DT_STR" length="3" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Age" dataType="DT_STR" length="30" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Date of Birth" dataType="DT_DBTIMESTAMP" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="nationality_rcd" dataType="DT_STR" length="3" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Nationality" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Race" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="ethnic_group_rcd_list" dataType="DT_NTEXT" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Ethnic Group" dataType="DT_NTEXT" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="religion_rcd" dataType="DT_STR" length="5" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Religion" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="sex_rcd" dataType="DT_STR" length="1" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Sex" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="home_address_country_rcd" dataType="DT_STR" length="3" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Home Country" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="residence_country_rcd" dataType="DT_STR" length="3" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Country of Residence" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Home Address" dataType="DT_WSTR" length="241" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="primary_service_rcd" dataType="DT_STR" length="5" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Primary Service" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Ward" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Room Code" dataType="DT_WSTR" length="20" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Room Class Name" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Primary Doctor" dataType="DT_WSTR" length="256" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="diagnosis_type_rcd" dataType="DT_STR" length="5" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="code" dataType="DT_STR" length="40" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Diagnosis" dataType="DT_NTEXT" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Discharge Reason" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Discharge Notes" dataType="DT_WSTR" length="3000" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Discharge Outcome" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Discharge Disposition" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;/referenceColumns&gt;&lt;/referenceMetadata&gt;</property>
                <property
                  containsID="true"
                  dataType="System.String"
                  description="Specifies the list of lineage identifiers that map to the parameters that the SQL statement in the SQLCommand property uses. Entries in the list are separated by semicolons."
                  name="ParameterMap">#{Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[patient_id]};#{Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[patient_visit_id]};#{Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[policy_id]};</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Determines whether duplicate keys in the reference data should be treated as errors when full cache mode is used."
                  name="TreatDuplicateKeysAsError">false</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Another stage table\Lookup.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[DBPROD03.AmalgaPROD]"
                  connectionManagerRefId="Package.ConnectionManagers[DBPROD03.AmalgaPROD]"
                  description="Connection manager used to access lookup data."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Another stage table\Lookup.Inputs[Lookup Input]"
                  name="Lookup Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Another stage table\Lookup.Inputs[Lookup Input].Columns[patient_id]"
                      cachedDataType="guid"
                      cachedName="patient_id"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[patient_id]">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table that a column joins."
                          name="JoinToReferenceColumn">patient_id</property>
                        <property
                          dataType="System.Null"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn" />
                      </properties>
                    </inputColumn>
                    <inputColumn
                      refId="Package\Another stage table\Lookup.Inputs[Lookup Input].Columns[patient_visit_id]"
                      cachedDataType="guid"
                      cachedName="patient_visit_id"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[patient_visit_id]">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table that a column joins."
                          name="JoinToReferenceColumn">patient_visit_id</property>
                        <property
                          dataType="System.Null"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn" />
                      </properties>
                    </inputColumn>
                    <inputColumn
                      refId="Package\Another stage table\Lookup.Inputs[Lookup Input].Columns[policy_id]"
                      cachedDataType="guid"
                      cachedName="policy_id"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[policy_id]">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table that a column joins."
                          name="JoinToReferenceColumn">policy_id</property>
                        <property
                          dataType="System.Null"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn" />
                      </properties>
                    </inputColumn>
                  </inputColumns>
                  <externalMetadataColumns />
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Another stage table\Lookup.Outputs[Lookup Match Output]"
                  errorOrTruncationOperation="Lookup"
                  exclusionGroup="1"
                  name="Lookup Match Output"
                  synchronousInputId="Package\Another stage table\Lookup.Inputs[Lookup Input]">
                  <externalMetadataColumns />
                </output>
                <output
                  refId="Package\Another stage table\Lookup.Outputs[Lookup No Match Output]"
                  description="The Lookup output that handles rows with no matching entries in the reference dataset. Use this output when the NoMatchBehavior property is set to &quot;Send rows with no matching entries to the no match output.&quot;"
                  exclusionGroup="1"
                  name="Lookup No Match Output"
                  synchronousInputId="Package\Another stage table\Lookup.Inputs[Lookup Input]">
                  <externalMetadataColumns />
                </output>
                <output
                  refId="Package\Another stage table\Lookup.Outputs[Lookup Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="Lookup Error Output"
                  synchronousInputId="Package\Another stage table\Lookup.Inputs[Lookup Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Another stage table\Lookup.Outputs[Lookup Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Another stage table\Lookup.Outputs[Lookup Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Another stage table\Lookup.Outputs[Lookup Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Another stage table\Lookup.Outputs[Lookup Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Another stage table\Stable table 2"
              componentClassID="Microsoft.OLEDBDestination"
              contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="OLE DB Destination"
              name="Stable table 2"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[ipd_census_2_stg2]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepIdentity">false</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepNulls">false</property>
                <property
                  dataType="System.String"
                  description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                  name="FastLoadOptions">TABLOCK,CHECK_CONSTRAINTS</property>
                <property
                  dataType="System.Int32"
                  description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                  name="FastLoadMaxInsertCommitSize">2147483647</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Another stage table\Stable table 2.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[DBPROD03.AHMC_DataAnalyticsDB]"
                  connectionManagerRefId="Package.ConnectionManagers[DBPROD03.AHMC_DataAnalyticsDB]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input]"
                  errorOrTruncationOperation="Insert"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="OLE DB Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[patient_id]"
                      cachedDataType="guid"
                      cachedName="patient_id"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[patient_id]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[patient_id]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[patient_visit_id]"
                      cachedDataType="guid"
                      cachedName="patient_visit_id"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[patient_visit_id]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[patient_visit_id]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Visit Start]"
                      cachedDataType="dbTimeStamp"
                      cachedName="Visit Start"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Visit Start]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Start]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Expected Discharge Date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="Expected Discharge Date"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Expected Discharge Date]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Expected Discharge Date]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Closure Date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="Closure Date"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Closure Date]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Closure Date]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[cancelled_date_time]"
                      cachedDataType="dbTimeStamp"
                      cachedName="cancelled_date_time"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[cancelled_date_time]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[cancelled_date_time]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Visit Type Name]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Visit Type Name"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Visit Type Name]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Type Name]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Visit Reason]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Visit Reason"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Visit Reason]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Reason]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Created By]"
                      cachedDataType="wstr"
                      cachedLength="256"
                      cachedName="Created By"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Created By]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Created By]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Place of Admission]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Place of Admission"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Place of Admission]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Place of Admission]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Length of Stay]"
                      cachedDataType="i4"
                      cachedName="Length of Stay"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Length of Stay]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Length of Stay]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[policy_id]"
                      cachedDataType="guid"
                      cachedName="policy_id"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[policy_id]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[policy_id]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Visit Policies]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Visit Policies"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Visit Policies]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Visit Policies]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[HN]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="20"
                      cachedName="HN"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[HN]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[HN]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Patient Name]"
                      cachedDataType="wstr"
                      cachedLength="256"
                      cachedName="Patient Name"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Patient Name]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Patient Name]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Region]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Region"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Region]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Region]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Subregion]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Subregion"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Subregion]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Subregion]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[City]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="City"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[City]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[City]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Address Type]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="3"
                      cachedName="Address Type"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Address Type]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Address Type]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Age]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="30"
                      cachedName="Age"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Age]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Age]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Date of Birth]"
                      cachedDataType="dbTimeStamp"
                      cachedName="Date of Birth"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Date of Birth]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Date of Birth]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Nationality]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Nationality"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Nationality]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Nationality]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Race]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Race"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Race]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Race]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Ethnic Group]"
                      cachedDataType="nText"
                      cachedName="Ethnic Group"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Ethnic Group]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Ethnic Group]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Religion]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Religion"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Religion]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Religion]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Sex]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Sex"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Sex]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Sex]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Home Country]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Home Country"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Home Country]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Home Country]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Country of Residence]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Country of Residence"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Country of Residence]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Country of Residence]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Home Address]"
                      cachedDataType="wstr"
                      cachedLength="241"
                      cachedName="Home Address"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Home Address]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Home Address]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Primary Service]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Primary Service"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Primary Service]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Primary Service]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Ward]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Ward"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Ward]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Ward]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Room Code]"
                      cachedDataType="wstr"
                      cachedLength="20"
                      cachedName="Room Code"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Room Code]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Room Code]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Room Class Name]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Room Class Name"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Room Class Name]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Room Class Name]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Primary Doctor]"
                      cachedDataType="wstr"
                      cachedLength="256"
                      cachedName="Primary Doctor"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Primary Doctor]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Primary Doctor]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[diagnosis_type_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="5"
                      cachedName="diagnosis_type_rcd"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[diagnosis_type_rcd]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[diagnosis_type_rcd]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Diagnosis]"
                      cachedDataType="nText"
                      cachedName="Diagnosis"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Diagnosis]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Diagnosis]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Discharge Reason]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Discharge Reason"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Reason]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Reason]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Discharge Notes]"
                      cachedDataType="wstr"
                      cachedLength="3000"
                      cachedName="Discharge Notes"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Notes]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Notes]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Discharge Outcome]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Discharge Outcome"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Outcome]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Outcome]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[Discharge Disposition]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Discharge Disposition"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Disposition]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[Discharge Disposition]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[visit_type_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="6"
                      cachedName="visit_type_rcd"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[visit_type_rcd]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[visit_type_rcd]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[nationality_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="3"
                      cachedName="nationality_rcd"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[nationality_rcd]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[nationality_rcd]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[ethnic_group_rcd_list]"
                      cachedDataType="nText"
                      cachedName="ethnic_group_rcd_list"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[ethnic_group_rcd_list]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[ethnic_group_rcd_list]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[religion_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="5"
                      cachedName="religion_rcd"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[religion_rcd]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[religion_rcd]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[sex_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="1"
                      cachedName="sex_rcd"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[sex_rcd]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[sex_rcd]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[home_address_country_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="3"
                      cachedName="home_address_country_rcd"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[home_address_country_rcd]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[home_address_country_rcd]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[residence_country_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="3"
                      cachedName="residence_country_rcd"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[residence_country_rcd]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[residence_country_rcd]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[primary_service_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="5"
                      cachedName="primary_service_rcd"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[primary_service_rcd]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[primary_service_rcd]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[code]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="40"
                      cachedName="code"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[code]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].Columns[policy_code]"
                      cachedDataType="wstr"
                      cachedLength="40"
                      cachedName="policy_code"
                      externalMetadataColumnId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[policy_code]"
                      lineageId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output].Columns[policy_code]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[patient_id]"
                      dataType="guid"
                      name="patient_id" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[patient_visit_id]"
                      dataType="guid"
                      name="patient_visit_id" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Visit Start]"
                      dataType="dbTimeStamp"
                      name="Visit Start" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Expected Discharge Date]"
                      dataType="dbTimeStamp"
                      name="Expected Discharge Date" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Closure Date]"
                      dataType="dbTimeStamp"
                      name="Closure Date" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[cancelled_date_time]"
                      dataType="dbTimeStamp"
                      name="cancelled_date_time" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Visit Type Name]"
                      dataType="wstr"
                      length="150"
                      name="Visit Type Name" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Visit Reason]"
                      dataType="wstr"
                      length="150"
                      name="Visit Reason" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Created By]"
                      dataType="wstr"
                      length="256"
                      name="Created By" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Place of Admission]"
                      dataType="wstr"
                      length="150"
                      name="Place of Admission" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Length of Stay]"
                      dataType="i4"
                      name="Length of Stay" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[policy_id]"
                      dataType="guid"
                      name="policy_id" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Visit Policies]"
                      dataType="wstr"
                      length="150"
                      name="Visit Policies" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[HN]"
                      codePage="1252"
                      dataType="str"
                      length="20"
                      name="HN" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Patient Name]"
                      dataType="wstr"
                      length="256"
                      name="Patient Name" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Region]"
                      dataType="wstr"
                      length="150"
                      name="Region" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Subregion]"
                      dataType="wstr"
                      length="150"
                      name="Subregion" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[City]"
                      dataType="wstr"
                      length="150"
                      name="City" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Address Type]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="Address Type" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Age]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="Age" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Date of Birth]"
                      dataType="dbTimeStamp"
                      name="Date of Birth" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Nationality]"
                      dataType="wstr"
                      length="150"
                      name="Nationality" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Race]"
                      dataType="wstr"
                      length="150"
                      name="Race" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Ethnic Group]"
                      dataType="nText"
                      name="Ethnic Group" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Religion]"
                      dataType="wstr"
                      length="150"
                      name="Religion" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Sex]"
                      dataType="wstr"
                      length="150"
                      name="Sex" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Home Country]"
                      dataType="wstr"
                      length="150"
                      name="Home Country" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Country of Residence]"
                      dataType="wstr"
                      length="150"
                      name="Country of Residence" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Home Address]"
                      dataType="wstr"
                      length="241"
                      name="Home Address" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Primary Service]"
                      dataType="wstr"
                      length="150"
                      name="Primary Service" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Ward]"
                      dataType="wstr"
                      length="150"
                      name="Ward" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Room Code]"
                      dataType="wstr"
                      length="20"
                      name="Room Code" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Room Class Name]"
                      dataType="wstr"
                      length="150"
                      name="Room Class Name" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Primary Doctor]"
                      dataType="wstr"
                      length="256"
                      name="Primary Doctor" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="diagnosis_type_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Diagnosis]"
                      dataType="nText"
                      name="Diagnosis" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Reason]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Reason" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Notes]"
                      dataType="wstr"
                      length="3000"
                      name="Discharge Notes" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Outcome]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Outcome" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Disposition]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Disposition" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[visit_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      name="visit_type_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[nationality_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="nationality_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[ethnic_group_rcd_list]"
                      dataType="nText"
                      name="ethnic_group_rcd_list" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[religion_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="religion_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[sex_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="sex_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[home_address_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="home_address_country_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[residence_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="residence_country_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[primary_service_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="primary_service_rcd" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[code]"
                      codePage="1252"
                      dataType="str"
                      length="40"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input].ExternalColumns[policy_code]"
                      dataType="wstr"
                      length="40"
                      name="policy_code" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Another stage table\Stable table 2.Outputs[OLE DB Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="OLE DB Destination Error Output"
                  synchronousInputId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Another stage table\Stable table 2.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Another stage table\Stable table 2.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Another stage table\Stable table 2.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Another stage table\Stable table 2.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Another stage table.Paths[Lookup No Match Output]"
              endId="Package\Another stage table\Stable table 2.Inputs[OLE DB Destination Input]"
              name="Lookup No Match Output"
              startId="Package\Another stage table\Lookup.Outputs[Lookup No Match Output]" />
            <path
              refId="Package\Another stage table.Paths[OLE DB Source Output]"
              endId="Package\Another stage table\Lookup.Inputs[Lookup Input]"
              name="OLE DB Source Output"
              startId="Package\Another stage table\From ipd_census_1.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Apply updates"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{209C8E4E-46E1-4402-B263-8B38F0F99ABB}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Apply updates"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{BA71D38C-B716-4CF6-A469-43B9B5CC5A15}"
          SQLTask:SqlStatementSource="update ipd_census_2&#xA;set [Closure Date] = src.[lkup_Closure Date],&#xA;    [cancelled_date_time] = src.[lkup_cancelled_date_time],&#xA;    [Length of Stay] = src.[lkup_Length of Stay],&#xA;&#x9;[Age] = src.[lkup_Age],&#xA;&#x9;--[Visit Policies] = src.[lkup_Visit Policies],&#xA;&#x9;--[policy_id] = src.[lkup_policy_id],&#xA;&#x9;[diagnosis_type_rcd] = src.[lkup_diagnosis_type_rcd],&#xA;&#x9;[Diagnosis] = src.[lkup_Diagnosis],&#xA;&#x9;[code] = src.[lkup_code],&#xA;&#x9;[Discharge Reason] = src.[lkup_Discharge Reason],&#xA;&#x9;[Discharge Notes] = src.[lkup_Discharge Notes],&#xA;&#x9;[Discharge Outcome] = src.[lkup_Discharge Outcome],&#xA;&#x9;[Discharge Disposition] = src.[lkup_Discharge Disposition]&#xA;from ipd_census_2_stg src left JOIN ipd_census_2 stage on src.patient_visit_id = stage.patient_visit_id&#xA;&#xA;&#xA;&#xA;truncate table ipd_census_2_stg" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Delete policy_id is not null"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{21AAAF92-9CC2-4E1B-8670-D5DF6A3F1978}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Delete policy_id is not null"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{BA71D38C-B716-4CF6-A469-43B9B5CC5A15}"
          SQLTask:SqlStatementSource="delete ipd_census_2&#xA;from ipd_census_2 src &#xA;inner join ipd_census_2_stg2 stage on src.patient_visit_id = stage.patient_visit_id&#xA;where src.patient_visit_id = stage.patient_visit_id&#xA;      and src.policy_id = stage.policy_id&#xA;&#xA;&#xA;--truncate table ipd_census_2_stg2" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Delete policy_id is null"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{97B1F0CD-0215-4213-BC94-1216902202AE}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Delete policy_id is null"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{BA71D38C-B716-4CF6-A469-43B9B5CC5A15}"
          SQLTask:SqlStatementSource="delete ipd_census_2  from ipd_census_2 src &#xA;inner join ipd_census_2_stg2 stage on src.patient_visit_id = stage.patient_visit_id&#xA;where src.patient_visit_id = stage.patient_visit_id&#xA;      and src.policy_id is null&#xA;&#xA;&#xA;truncate table ipd_census_2_stg2" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Dump IPD Census"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{1F7FE178-BF32-45D3-9A61-6227ACD41993}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Dump IPD Census"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Dump IPD Census\From AmalgaPROD"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="From AmalgaPROD"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">DECLARE @date1 DATETIME
DECLARE @date2 DATETIME

SET @date1 = '01/01/2018 00:00:00.000'
SET @date2 = SSIS.dbo.fn_TwoHRDateTo()
--select count(distinct tempc.patient_visit_id)

--from (

select tempb.patient_id
	   ,tempb.patient_visit_id
	   ,tempb.[Visit Start]
	   ,tempb.[Expected Discharge Date]
	   ,tempb.[Closure Date]
	   ,tempb.cancelled_date_time
	   ,tempb.visit_type_rcd
	   ,tempb.[Visit Type Name]
	   ,tempb.[Visit Reason]
	   ,tempb.[Created By]
	   ,tempb.[Place of Admission]
	   ,tempb.[Length of Stay]
	   ,tempb.[Visit Policies]
	   ,tempb.policy_id
	   ,tempb.policy_code
	   ,tempb.HN
	   ,tempb.[Patient Name]
	   ,tempb.Region
	   ,tempb.Subregion
	   ,tempb.City
	   ,tempb.[Address Type]
	   ,case when tempb.Age is null then (cast(cast((DATEDIFF(dd,tempb.[Date of Birth],GETDATE()) / 365.25) as int) as varchar)) else tempb.Age end as Age
	   ,tempb.[Date of Birth]
	   ,tempb.nationality_rcd
	   ,tempb.Nationality
	   ,tempb.Race
	   ,tempb.ethnic_group_rcd_list
	   ,tempb.[Ethnic Group]
	   ,tempb.religion_rcd
	   ,tempb.Religion
	   ,tempb.sex_rcd
	   ,tempb.Sex
	   ,tempb.home_address_country_rcd
	   ,tempb.[Home Country]
	   ,tempb.residence_country_rcd
	   ,tempb.[Country of Residence]
	   ,tempb.[Home Address]
	   ,tempb.primary_service_rcd
	   ,tempb.[Primary Service]
	   ,tempb.Ward
	   ,tempb.[Room Code]
	   ,tempb.[Room Class Name]
	   ,tempb.[Primary Doctor]
	   ,tempb.diagnosis_type_rcd
	   ,tempb.code
	   ,tempb.Diagnosis
	   ,tempb.[Discharge Reason]
	   ,tempb.[Discharge Notes]
	   ,tempb.[Discharge Outcome]
	   ,tempb.[Discharge Disposition]

from (

select temp.patient_id
	   ,temp.patient_visit_id
	   ,temp.[Visit Start]
	   ,temp.[Expected Discharge Date]
	   ,temp.[Closure Date]
	   ,temp.cancelled_date_time
	   ,temp.visit_type_rcd
	   ,temp.[Visit Type Name]
	   ,temp.[Visit Reason]
	   ,temp.[Created By]
	   ,temp.[Place of Admission]
	   ,temp.[Length of Stay]
	   ,temp.[Visit Policies]
	   ,temp.policy_id
	   ,temp.policy_code
	   ,temp.HN
	   ,temp.[Patient Name]
	   ,temp.Region
	   ,temp.Subregion
	   ,temp.City
	   ,temp.[Address Type]
	   ,temp.Age
	   ,temp.[Date of Birth]
	   ,temp.nationality_rcd
	   ,temp.Nationality
	   ,temp.Race
	   ,temp.ethnic_group_rcd_list
	   ,temp.[Ethnic Group]
	   ,temp.religion_rcd
	   ,temp.Religion
	   ,temp.sex_rcd
	   ,temp.Sex
	   ,temp.home_address_country_rcd
	   ,temp.[Home Country]
	   ,temp.residence_country_rcd
	   ,temp.[Country of Residence]
	   ,temp.[Home Address]
	   ,temp.primary_service_rcd
	   ,temp.[Primary Service]
	   ,temp.Ward
	   ,temp.[Room Code]
	   ,temp.[Room Class Name]
	   ,temp.[Primary Doctor]
	   ,pvdv.diagnosis_type_rcd
	   ,pvdv.coding_type_rcd
	   ,pvdv.active_flag
	   ,pvdv.primary_flag
	   ,pvdv.current_visit_diagnosis_flag
	   ,csed.coding_system_rcd
	   ,csed.code
       ,csed.description as Diagnosis
	   ,temp.[Discharge Reason]
	   ,temp.[Discharge Notes]
	   ,temp.[Discharge Outcome]
	   ,temp.[Discharge Disposition]

from (

select distinct apv.patient_id
	   ,api.patient_visit_id
	   ,api.actual_visit_date_time as [Visit Start]
	   ,api.expected_discharge_date_time as [Expected Discharge Date]
	   ,api.closure_date_time as [Closure Date]
	   ,api.cancelled_date_time
	   ,api.visit_type_rcd
	   ,api.visit_type_name_l as [Visit Type Name]
	   --,stuff((select '; ' + name_l from patient_visit_reason a1 left join visit_reason_ref a2 on a1.visit_reason_rcd = a2.visit_reason_rcd
				--														where a1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Reason]
	   ,vrr.name_l as [Visit Reason]
	   ,emp1.display_name_l as [Created By]
	   ,api.created_from_area_name_l as [Place of Admission]
	   ,datediff(dd,api.actual_visit_date_time,api.closure_date_time) as [Length of Stay]
	   --,stuff((select '; ' + b1.policy_name_l from api_patient_visit_policy_view b1 where b1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Policies]
	   ,ISNULL(apvp.policy_name_l, 'Self Pay') as [Visit Policies]
	   ,apvp.policy_id
	   ,apvp.policy_code
	   ,apv.visible_patient_id as HN
	   ,apv.display_name_l as [Patient Name]
	   ,case when ADNV.city is NULL then city.city_id else ADNV.city_id end as city_id
	   ,case when ADNV.city is NULL then city.name_l else ADNV.city end as City
	   ,case when adnv.city_id is NOT NULL then  (SELECT region_id
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT region_id								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as region_id
	   ,case when adnv.city_id is NOT NULL then  (SELECT name_l
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT name_l								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as Region
	    ,case when adnv.city_id is not NULL then (SELECT subr.subregion_id as subregion
															from AmalgaPROD.dbo.subregion_nl_view subr
															where subr.subregion_id = city.subregion_id) else (SELECT subr.subregion_id as subregion
																												from AmalgaPROD.dbo.subregion_nl_view subr
																												where subr.subregion_id = adnv.subregion_id) end as subregion_id
		,case when adnv.city_id is not NULL then (SELECT subr.name_l as subregion
													from AmalgaPROD.dbo.subregion_nl_view subr
													where subr.subregion_id = adnv.subregion_id) else (SELECT subr.name_l as subregion
																										from AmalgaPROD.dbo.subregion_nl_view subr
																										where subr.subregion_id = adnv.subregion_id) end as Subregion
		,case when panv.person_address_type_rcd is NULL then 'N/A' ELSE panv.person_address_type_rcd end as [Address Type]
		--,datediff(dd,apv.date_of_birth, getdate()) / 365 as Age
		,cast(cast((DATEDIFF(dd,apv.date_of_birth,api.closure_date_time) / 365.25) as int) as varchar) as Age
		,apv.date_of_birth as [Date of Birth]
		,apv.nationality_rcd
		,apv.nationality_name_l as Nationality
		,apv.race_name_l as Race
		,case when apv.ethnic_group_rcd_list is null then 'UNK' else apv.ethnic_group_rcd_list end as ethnic_group_rcd_list
		,case when apv.ethnic_group_name_l_list is null then 'Unknown' else apv.ethnic_group_name_l_list end as [Ethnic Group]
		,apv.religion_rcd
		,apv.religion_name_l as Religion
		,apv.sex_rcd
		,apv.sex_name_l as Sex
		,case when apv.home_address_country_rcd is null then 'UNK' else apv.home_address_country_rcd end as home_address_country_rcd
		,case when apv.home_address_country_name_l is null then 'Unknown' else apv.home_address_country_name_l end as [Home Country]
		,apv.residence_country_rcd
		,apv.residence_country_name_l as [Country of Residence]
		,ISNULL(apv.home_address_line_1_l,'') + ' ' + ISNULL(apv.home_address_line_2_l,'') + ISNULL(apv.home_address_line_3_l,'') as [Home Address]
		,api.primary_service_rcd
		,api.primary_service_name_l as [Primary Service]
		,(select top 1 ward_name_l from bed_entry_info_view t1 
					where t1.patient_visit_id = api.patient_visit_id
					order by start_date_time desc) as Ward
	    ,api.admission_bed_code as [Room Code]
		,api.admission_room_charge_set_name_l as [Room Class Name]
		,[Primary Doctor] = (Select top 1 display_name_l from person_formatted_name_iview pfn 
		                            left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
		                            where cr.employee_id = pfn.person_id
									      and cr.caregiver_role_type_rcd = 'PRIDR'
		                                  and cr.caregiver_role_status_rcd = 'ACTIV'
										  and cr.inactivated_date_time is null
										  order by cr.lu_updated desc)
		,api.discharge_reason_name_l as [Discharge Reason]
		,api.discharge_notes as [Discharge Notes]
		,api.discharge_outcome_name_l as [Discharge Outcome]
		,api.discharge_disposition_name_l as [Discharge Disposition]

FROM api_patient_visit_view api 
			left join api_patient_view apv on api.patient_id = apv.patient_id
			left join user_account ua on api.created_by = ua.user_id
			left join person_formatted_name_iview emp1 on ua.person_id = emp1.person_id
			left join api_patient_visit_policy_view apvp on api.patient_visit_id = apvp.patient_visit_id
			left join address_label_view al on apv.home_address_id = al.address_id
			left join person_address_nl_view panv ON apv.patient_id = panv.person_id
			left join address_nl_view adnv ON al.address_id = adnv.address_id
			left join city_nl_view city on ADNV.city_id = city.city_id
			--left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
			--left join person_formatted_name_iview emp2 on emp2.person_id = cr.employee_id
			left join patient_visit_reason pvr on api.patient_visit_id = pvr.patient_visit_id
			left join visit_reason_ref vrr on pvr.visit_reason_rcd = vrr.visit_reason_rcd
			--left join country_ref cref on apv.home_address_country_rcd = cref.country_rcd


where api.visit_type_rcd in ('V1', 'V2')

) as temp
			left join patient_visit_diagnosis_view pvdv on pvdv.patient_visit_id = temp.patient_visit_id
			left join coding_system_element_description csed on csed.code = pvdv.code

where temp.[Address Type] in ('H1','N/A')
	  and (csed.coding_system_rcd is null or csed.coding_system_rcd in ('ICD10', 'ICD9CM'))
	  --and (pvdv.coding_type_rcd is null or pvdv.coding_type_rcd = 'PRI')
	  and isnull(pvdv.current_visit_diagnosis_flag,0) = 1
      and (select count(*) from patient_visit_diagnosis_view
				where patient_visit_id = pvdv.patient_visit_id
				and current_visit_diagnosis_flag = 1) &gt; 0

UNION ALL

select temp.patient_id
	   ,temp.patient_visit_id
	   ,temp.[Visit Start]
	   ,temp.[Expected Discharge Date]
	   ,temp.[Closure Date]
	   ,temp.cancelled_date_time
	   ,temp.visit_type_rcd
	   ,temp.[Visit Type Name]
	   ,temp.[Visit Reason]
	   ,temp.[Created By]
	   ,temp.[Place of Admission]
	   ,temp.[Length of Stay]
	   ,temp.[Visit Policies]
	   ,temp.policy_id
	   ,temp.policy_code
	   ,temp.HN
	   ,temp.[Patient Name]
	   ,temp.Region
	   ,temp.Subregion
	   ,temp.City
	   ,temp.[Address Type]
	   ,temp.Age
	   ,temp.[Date of Birth]
	   ,temp.nationality_rcd
	   ,temp.Nationality
	   ,temp.Race
	   ,temp.ethnic_group_rcd_list
	   ,temp.[Ethnic Group]
	   ,temp.religion_rcd
	   ,temp.Religion
	   ,temp.sex_rcd
	   ,temp.Sex
	   ,temp.home_address_country_rcd
	   ,temp.[Home Country]
	   ,temp.residence_country_rcd
	   ,temp.[Country of Residence]
	   ,temp.[Home Address]
	   ,temp.primary_service_rcd
	   ,temp.[Primary Service]
	   ,temp.Ward
	   ,temp.[Room Code]
	   ,temp.[Room Class Name]
	   ,temp.[Primary Doctor]
	   ,pvdv.diagnosis_type_rcd
	   ,pvdv.coding_type_rcd
	   ,pvdv.active_flag
	   ,pvdv.primary_flag
	   ,pvdv.current_visit_diagnosis_flag
	   ,csed.coding_system_rcd
	   ,csed.code
       ,csed.description as Diagnosis
	   ,temp.[Discharge Reason]
	   ,temp.[Discharge Notes]
	   ,temp.[Discharge Outcome]
	   ,temp.[Discharge Disposition]

from (

select distinct apv.patient_id
	   ,api.patient_visit_id
	   ,api.actual_visit_date_time as [Visit Start]
	   ,api.expected_discharge_date_time as [Expected Discharge Date]
	   ,api.closure_date_time as [Closure Date]
	   ,api.cancelled_date_time
	   ,api.visit_type_rcd
	   ,api.visit_type_name_l as [Visit Type Name]
	   --,stuff((select '; ' + name_l from patient_visit_reason a1 left join visit_reason_ref a2 on a1.visit_reason_rcd = a2.visit_reason_rcd
				--														where a1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Reason]
	   ,vrr.name_l as [Visit Reason]
	   ,emp1.display_name_l as [Created By]
	   ,api.created_from_area_name_l as [Place of Admission]
	   ,datediff(dd,api.actual_visit_date_time,api.closure_date_time) as [Length of Stay]
	   --,stuff((select '; ' + b1.policy_name_l from api_patient_visit_policy_view b1 where b1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Policies]
	   ,ISNULL(apvp.policy_name_l, 'Self Pay') as [Visit Policies]
	   ,apvp.policy_id
	   ,apvp.policy_code
	   ,apv.visible_patient_id as HN
	   ,apv.display_name_l as [Patient Name]
	   ,case when ADNV.city is NULL then city.city_id else ADNV.city_id end as city_id
	   ,case when ADNV.city is NULL then city.name_l else ADNV.city end as City
	   ,case when adnv.city_id is NOT NULL then  (SELECT region_id
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT region_id								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as region_id
	   ,case when adnv.city_id is NOT NULL then  (SELECT name_l
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT name_l								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as Region
	    ,case when adnv.city_id is not NULL then (SELECT subr.subregion_id as subregion
															from AmalgaPROD.dbo.subregion_nl_view subr
															where subr.subregion_id = city.subregion_id) else (SELECT subr.subregion_id as subregion
																												from AmalgaPROD.dbo.subregion_nl_view subr
																												where subr.subregion_id = adnv.subregion_id) end as subregion_id
		,case when adnv.city_id is not NULL then (SELECT subr.name_l as subregion
													from AmalgaPROD.dbo.subregion_nl_view subr
													where subr.subregion_id = adnv.subregion_id) else (SELECT subr.name_l as subregion
																										from AmalgaPROD.dbo.subregion_nl_view subr
																										where subr.subregion_id = adnv.subregion_id) end as Subregion
		,case when panv.person_address_type_rcd is NULL then 'N/A' ELSE panv.person_address_type_rcd end as [Address Type]
		--,datediff(dd,apv.date_of_birth, getdate()) / 365 as Age
		,cast(cast((DATEDIFF(dd,apv.date_of_birth,api.closure_date_time) / 365.25) as int) as varchar) as Age
		,apv.date_of_birth as [Date of Birth]
		,apv.nationality_rcd
		,apv.nationality_name_l as Nationality
		,apv.race_name_l as Race
		,case when apv.ethnic_group_rcd_list is null then 'UNK' else apv.ethnic_group_rcd_list end as ethnic_group_rcd_list
		,case when apv.ethnic_group_name_l_list is null then 'Unknown' else apv.ethnic_group_name_l_list end as [Ethnic Group]
		,apv.religion_rcd
		,apv.religion_name_l as Religion
		,apv.sex_rcd
		,apv.sex_name_l as Sex
		,case when apv.home_address_country_rcd is null then 'UNK' else apv.home_address_country_rcd end as home_address_country_rcd
		,case when apv.home_address_country_name_l is null then 'Unknown' else apv.home_address_country_name_l end as [Home Country]
		,apv.residence_country_rcd
		,apv.residence_country_name_l as [Country of Residence]
		,ISNULL(apv.home_address_line_1_l,'') + ' ' + ISNULL(apv.home_address_line_2_l,'') + ISNULL(apv.home_address_line_3_l,'') as [Home Address]
		,api.primary_service_rcd
		,api.primary_service_name_l as [Primary Service]
		,(select top 1 ward_name_l from bed_entry_info_view t1 
					where t1.patient_visit_id = api.patient_visit_id
					order by start_date_time desc) as Ward
	    ,api.admission_bed_code as [Room Code]
		,api.admission_room_charge_set_name_l as [Room Class Name]
		,[Primary Doctor] = (Select top 1 display_name_l from person_formatted_name_iview pfn 
		                            left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
		                            where cr.employee_id = pfn.person_id
									      and cr.caregiver_role_type_rcd = 'PRIDR'
		                                  and cr.caregiver_role_status_rcd = 'ACTIV'
										  and cr.inactivated_date_time is null
										  order by cr.lu_updated desc)
		,api.discharge_reason_name_l as [Discharge Reason]
		,api.discharge_notes as [Discharge Notes]
		,api.discharge_outcome_name_l as [Discharge Outcome]
		,api.discharge_disposition_name_l as [Discharge Disposition]

FROM api_patient_visit_view api 
			left join api_patient_view apv on api.patient_id = apv.patient_id
			left join user_account ua on api.created_by = ua.user_id
			left join person_formatted_name_iview emp1 on ua.person_id = emp1.person_id
			left join api_patient_visit_policy_view apvp on api.patient_visit_id = apvp.patient_visit_id
			left join address_label_view al on apv.home_address_id = al.address_id
			left join person_address_nl_view panv ON apv.patient_id = panv.person_id
			left join address_nl_view adnv ON al.address_id = adnv.address_id
			left join city_nl_view city on ADNV.city_id = city.city_id
			--left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
			--left join person_formatted_name_iview emp2 on emp2.person_id = cr.employee_id
			left join patient_visit_reason pvr on api.patient_visit_id = pvr.patient_visit_id
			left join visit_reason_ref vrr on pvr.visit_reason_rcd = vrr.visit_reason_rcd
			--left join country_ref cref on apv.home_address_country_rcd = cref.country_rcd

where api.visit_type_rcd in ('V1', 'V2')

) as temp
			left join patient_visit_diagnosis_view pvdv on temp.patient_visit_id = pvdv.patient_visit_id
			left join coding_system_element_description csed on pvdv.code = csed.code

where temp.[Address Type] in ('H1','N/A')
	  and (csed.coding_system_rcd is null or csed.coding_system_rcd in ('ICD10', 'ICD9CM'))
	  and (pvdv.coding_type_rcd is null or pvdv.coding_type_rcd = 'PRI')
      and (select count(*) from patient_visit_diagnosis_view
				where patient_visit_id = pvdv.patient_visit_id
				and current_visit_diagnosis_flag = 1) = 0

) as tempb
where tempb.[Visit Start] between @date1 and @date2
	  
--) as tempc</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">2</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\Dump IPD Census\From AmalgaPROD.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[DBPROD03.AmalgaPROD]"
                  connectionManagerRefId="Package.ConnectionManagers[DBPROD03.AmalgaPROD]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[patient_id]"
                      dataType="guid"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[patient_id]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[patient_id]"
                      name="patient_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[patient_visit_id]"
                      dataType="guid"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[patient_visit_id]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[patient_visit_id]"
                      name="patient_visit_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Start]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Visit Start]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Start]"
                      name="Visit Start"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Expected Discharge Date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Expected Discharge Date]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Expected Discharge Date]"
                      name="Expected Discharge Date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Closure Date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Closure Date]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Closure Date]"
                      name="Closure Date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Type Name]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Visit Type Name]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Type Name]"
                      name="Visit Type Name"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Reason]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Visit Reason]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Reason]"
                      name="Visit Reason"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Created By]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Created By]"
                      length="256"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Created By]"
                      name="Created By"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Place of Admission]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Place of Admission]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Place of Admission]"
                      name="Place of Admission"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Length of Stay]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Length of Stay]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Length of Stay]"
                      name="Length of Stay"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Policies]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Visit Policies]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Policies]"
                      name="Visit Policies"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[HN]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[HN]"
                      length="20"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[HN]"
                      name="HN"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Patient Name]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Patient Name]"
                      length="256"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Patient Name]"
                      name="Patient Name"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Region]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Region]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Region]"
                      name="Region"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Subregion]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Subregion]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Subregion]"
                      name="Subregion"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[City]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[City]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[City]"
                      name="City"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Address Type]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Address Type]"
                      length="3"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Address Type]"
                      name="Address Type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Age]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Age]"
                      length="30"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Age]"
                      name="Age"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Date of Birth]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Date of Birth]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Date of Birth]"
                      name="Date of Birth"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Nationality]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Nationality]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Nationality]"
                      name="Nationality"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Race]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Race]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Race]"
                      name="Race"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Ethnic Group]"
                      dataType="nText"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Ethnic Group]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Ethnic Group]"
                      name="Ethnic Group"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Religion]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Religion]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Religion]"
                      name="Religion"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Sex]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Sex]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Sex]"
                      name="Sex"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Home Country]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Home Country]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Home Country]"
                      name="Home Country"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Country of Residence]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Country of Residence]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Country of Residence]"
                      name="Country of Residence"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Home Address]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Home Address]"
                      length="241"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Home Address]"
                      name="Home Address"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Primary Service]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Primary Service]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Primary Service]"
                      name="Primary Service"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Ward]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Ward]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Ward]"
                      name="Ward"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Room Code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Room Code]"
                      length="20"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Room Code]"
                      name="Room Code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Room Class Name]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Room Class Name]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Room Class Name]"
                      name="Room Class Name"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Primary Doctor]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Primary Doctor]"
                      length="256"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Primary Doctor]"
                      name="Primary Doctor"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[diagnosis_type_rcd]"
                      length="5"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[diagnosis_type_rcd]"
                      name="diagnosis_type_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Diagnosis]"
                      dataType="nText"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Diagnosis]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Diagnosis]"
                      name="Diagnosis"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Reason]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Discharge Reason]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Reason]"
                      name="Discharge Reason"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Notes]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Discharge Notes]"
                      length="3000"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Notes]"
                      name="Discharge Notes"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Outcome]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Discharge Outcome]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Outcome]"
                      name="Discharge Outcome"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Disposition]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Discharge Disposition]"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Disposition]"
                      name="Discharge Disposition"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[cancelled_date_time]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[cancelled_date_time]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[cancelled_date_time]"
                      name="cancelled_date_time"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[policy_id]"
                      dataType="guid"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[policy_id]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[policy_id]"
                      name="policy_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[visit_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[visit_type_rcd]"
                      length="6"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[visit_type_rcd]"
                      name="visit_type_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[nationality_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[nationality_rcd]"
                      length="3"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[nationality_rcd]"
                      name="nationality_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[ethnic_group_rcd_list]"
                      dataType="nText"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[ethnic_group_rcd_list]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[ethnic_group_rcd_list]"
                      name="ethnic_group_rcd_list"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[religion_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[religion_rcd]"
                      length="5"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[religion_rcd]"
                      name="religion_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[sex_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[sex_rcd]"
                      length="1"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[sex_rcd]"
                      name="sex_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[home_address_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[home_address_country_rcd]"
                      length="3"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[home_address_country_rcd]"
                      name="home_address_country_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[residence_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[residence_country_rcd]"
                      length="3"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[residence_country_rcd]"
                      name="residence_country_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[primary_service_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[primary_service_rcd]"
                      length="5"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[primary_service_rcd]"
                      name="primary_service_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[code]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[code]"
                      length="40"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[policy_code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[policy_code]"
                      length="40"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[policy_code]"
                      name="policy_code"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[patient_id]"
                      dataType="guid"
                      name="patient_id" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[patient_visit_id]"
                      dataType="guid"
                      name="patient_visit_id" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Visit Start]"
                      dataType="dbTimeStamp"
                      name="Visit Start" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Expected Discharge Date]"
                      dataType="dbTimeStamp"
                      name="Expected Discharge Date" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Closure Date]"
                      dataType="dbTimeStamp"
                      name="Closure Date" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Visit Type Name]"
                      dataType="wstr"
                      length="150"
                      name="Visit Type Name" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Visit Reason]"
                      dataType="wstr"
                      length="150"
                      name="Visit Reason" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Created By]"
                      dataType="wstr"
                      length="256"
                      name="Created By" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Place of Admission]"
                      dataType="wstr"
                      length="150"
                      name="Place of Admission" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Length of Stay]"
                      dataType="i4"
                      name="Length of Stay" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Visit Policies]"
                      dataType="wstr"
                      length="150"
                      name="Visit Policies" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[HN]"
                      codePage="1252"
                      dataType="str"
                      length="20"
                      name="HN" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Patient Name]"
                      dataType="wstr"
                      length="256"
                      name="Patient Name" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Region]"
                      dataType="wstr"
                      length="150"
                      name="Region" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Subregion]"
                      dataType="wstr"
                      length="150"
                      name="Subregion" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[City]"
                      dataType="wstr"
                      length="150"
                      name="City" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Address Type]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="Address Type" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Age]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="Age" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Date of Birth]"
                      dataType="dbTimeStamp"
                      name="Date of Birth" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Nationality]"
                      dataType="wstr"
                      length="150"
                      name="Nationality" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Race]"
                      dataType="wstr"
                      length="150"
                      name="Race" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Ethnic Group]"
                      dataType="nText"
                      name="Ethnic Group" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Religion]"
                      dataType="wstr"
                      length="150"
                      name="Religion" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Sex]"
                      dataType="wstr"
                      length="150"
                      name="Sex" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Home Country]"
                      dataType="wstr"
                      length="150"
                      name="Home Country" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Country of Residence]"
                      dataType="wstr"
                      length="150"
                      name="Country of Residence" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Home Address]"
                      dataType="wstr"
                      length="241"
                      name="Home Address" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Primary Service]"
                      dataType="wstr"
                      length="150"
                      name="Primary Service" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Ward]"
                      dataType="wstr"
                      length="150"
                      name="Ward" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Room Code]"
                      dataType="wstr"
                      length="20"
                      name="Room Code" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Room Class Name]"
                      dataType="wstr"
                      length="150"
                      name="Room Class Name" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Primary Doctor]"
                      dataType="wstr"
                      length="256"
                      name="Primary Doctor" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="diagnosis_type_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Diagnosis]"
                      dataType="nText"
                      name="Diagnosis" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Discharge Reason]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Reason" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Discharge Notes]"
                      dataType="wstr"
                      length="3000"
                      name="Discharge Notes" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Discharge Outcome]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Outcome" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[Discharge Disposition]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Disposition" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[cancelled_date_time]"
                      dataType="dbTimeStamp"
                      name="cancelled_date_time" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[policy_id]"
                      dataType="guid"
                      name="policy_id" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[visit_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      name="visit_type_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[nationality_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="nationality_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[ethnic_group_rcd_list]"
                      dataType="nText"
                      name="ethnic_group_rcd_list" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[religion_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="religion_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[sex_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="sex_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[home_address_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="home_address_country_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[residence_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="residence_country_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[primary_service_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="primary_service_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[code]"
                      codePage="1252"
                      dataType="str"
                      length="40"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].ExternalColumns[policy_code]"
                      dataType="wstr"
                      length="40"
                      name="policy_code" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[patient_id]"
                      dataType="guid"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[patient_id]"
                      name="patient_id" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[patient_visit_id]"
                      dataType="guid"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[patient_visit_id]"
                      name="patient_visit_id" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Visit Start]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Visit Start]"
                      name="Visit Start" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Expected Discharge Date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Expected Discharge Date]"
                      name="Expected Discharge Date" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Closure Date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Closure Date]"
                      name="Closure Date" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[cancelled_date_time]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[cancelled_date_time]"
                      name="cancelled_date_time" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[visit_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[visit_type_rcd]"
                      name="visit_type_rcd" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Visit Type Name]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Visit Type Name]"
                      name="Visit Type Name" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Visit Reason]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Visit Reason]"
                      name="Visit Reason" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Created By]"
                      dataType="wstr"
                      length="256"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Created By]"
                      name="Created By" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Place of Admission]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Place of Admission]"
                      name="Place of Admission" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Length of Stay]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Length of Stay]"
                      name="Length of Stay" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Visit Policies]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Visit Policies]"
                      name="Visit Policies" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[policy_id]"
                      dataType="guid"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[policy_id]"
                      name="policy_id" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[policy_code]"
                      dataType="wstr"
                      length="40"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[policy_code]"
                      name="policy_code" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[HN]"
                      codePage="1252"
                      dataType="str"
                      length="20"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[HN]"
                      name="HN" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Patient Name]"
                      dataType="wstr"
                      length="256"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Patient Name]"
                      name="Patient Name" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Region]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Region]"
                      name="Region" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Subregion]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Subregion]"
                      name="Subregion" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[City]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[City]"
                      name="City" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Address Type]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Address Type]"
                      name="Address Type" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Age]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Age]"
                      name="Age" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Date of Birth]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Date of Birth]"
                      name="Date of Birth" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[nationality_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[nationality_rcd]"
                      name="nationality_rcd" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Nationality]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Nationality]"
                      name="Nationality" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Race]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Race]"
                      name="Race" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[ethnic_group_rcd_list]"
                      dataType="nText"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[ethnic_group_rcd_list]"
                      name="ethnic_group_rcd_list" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Ethnic Group]"
                      dataType="nText"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Ethnic Group]"
                      name="Ethnic Group" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[religion_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[religion_rcd]"
                      name="religion_rcd" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Religion]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Religion]"
                      name="Religion" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[sex_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[sex_rcd]"
                      name="sex_rcd" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Sex]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Sex]"
                      name="Sex" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[home_address_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[home_address_country_rcd]"
                      name="home_address_country_rcd" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Home Country]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Home Country]"
                      name="Home Country" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[residence_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[residence_country_rcd]"
                      name="residence_country_rcd" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Country of Residence]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Country of Residence]"
                      name="Country of Residence" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Home Address]"
                      dataType="wstr"
                      length="241"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Home Address]"
                      name="Home Address" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[primary_service_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[primary_service_rcd]"
                      name="primary_service_rcd" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Primary Service]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Primary Service]"
                      name="Primary Service" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Ward]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Ward]"
                      name="Ward" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Room Code]"
                      dataType="wstr"
                      length="20"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Room Code]"
                      name="Room Code" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Room Class Name]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Room Class Name]"
                      name="Room Class Name" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Primary Doctor]"
                      dataType="wstr"
                      length="256"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Primary Doctor]"
                      name="Primary Doctor" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[diagnosis_type_rcd]"
                      name="diagnosis_type_rcd" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[code]"
                      codePage="1252"
                      dataType="str"
                      length="40"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Diagnosis]"
                      dataType="nText"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Diagnosis]"
                      name="Diagnosis" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Discharge Reason]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Discharge Reason]"
                      name="Discharge Reason" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Discharge Notes]"
                      dataType="wstr"
                      length="3000"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Discharge Notes]"
                      name="Discharge Notes" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Discharge Outcome]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Discharge Outcome]"
                      name="Discharge Outcome" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Discharge Disposition]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[Discharge Disposition]"
                      name="Discharge Disposition" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Dump IPD Census\Lookup"
              componentClassID="Microsoft.Lookup"
              contactInfo="Lookup;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;6"
              description="Joins additional columns to the data flow by looking up values in a table. For example, join to the 'employee id' column the employees table to get 'hire date' and 'employee name'. We recommend this transformation when the lookup table can fit into memory."
              name="Lookup"
              usesDispositions="true"
              version="6">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement that generates the lookup table."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">select * from [dbo].[ipd_census_2]</property>
                <property
                  dataType="System.String"
                  description="Specifies a SQL statement that uses parameters to generate the lookup table."
                  expressionType="Notify"
                  name="SqlCommandParam"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">select * from (select * from [dbo].[ipd_census_2]) [refTable]
where [refTable].[patient_id] = ? and [refTable].[patient_visit_id] = ? and [refTable].[policy_id] = ?</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the type of connection used to access the reference dataset."
                  name="ConnectionType"
                  typeConverter="LookupConnectionType">0</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the cache type of the lookup table."
                  name="CacheType"
                  typeConverter="CacheType">0</property>
                <property
                  dataType="System.Int32"
                  description="Specifies how the Lookup transformation handles rows without matching entries in the reference data set."
                  name="NoMatchBehavior"
                  typeConverter="LookupNoMatchBehavior">1</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the percentage of the cache that is allocated for rows with no matching entries in the reference dataset."
                  name="NoMatchCachePercentage">0</property>
                <property
                  dataType="System.Int32"
                  description="Maximum Memory Usage for Reference Cache on a 32 bit platform."
                  name="MaxMemoryUsage">25</property>
                <property
                  dataType="System.Int64"
                  description="Maximum Memory Usage for Reference Cache on a 64 bit platform."
                  name="MaxMemoryUsage64">25</property>
                <property
                  dataType="System.String"
                  description="Indicates whether to reference metadata in an XML format."
                  name="ReferenceMetadataXml">&lt;referenceMetadata&gt;&lt;referenceColumns&gt;&lt;referenceColumn name="patient_id" dataType="DT_GUID" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="patient_visit_id" dataType="DT_GUID" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Visit Start" dataType="DT_DBTIMESTAMP" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Expected Discharge Date" dataType="DT_DBTIMESTAMP" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Closure Date" dataType="DT_DBTIMESTAMP" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Visit Type Name" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Visit Reason" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Created By" dataType="DT_WSTR" length="256" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Place of Admission" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Length of Stay" dataType="DT_I4" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Visit Policies" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="HN" dataType="DT_STR" length="20" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Patient Name" dataType="DT_WSTR" length="256" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Region" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Subregion" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="City" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Address Type" dataType="DT_STR" length="3" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Age" dataType="DT_STR" length="30" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Date of Birth" dataType="DT_DBTIMESTAMP" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Nationality" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Race" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Ethnic Group" dataType="DT_NTEXT" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Religion" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Sex" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Home Country" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Country of Residence" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Home Address" dataType="DT_WSTR" length="241" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Primary Service" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Ward" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Room Code" dataType="DT_WSTR" length="20" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Room Class Name" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Primary Doctor" dataType="DT_WSTR" length="256" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="diagnosis_type_rcd" dataType="DT_STR" length="5" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="Diagnosis" dataType="DT_NTEXT" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Discharge Reason" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Discharge Notes" dataType="DT_WSTR" length="3000" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Discharge Outcome" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="Discharge Disposition" dataType="DT_WSTR" length="150" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="cancelled_date_time" dataType="DT_DBTIMESTAMP" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="policy_id" dataType="DT_GUID" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="visit_type_rcd" dataType="DT_STR" length="6" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="nationality_rcd" dataType="DT_STR" length="3" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="ethnic_group_rcd_list" dataType="DT_NTEXT" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="religion_rcd" dataType="DT_STR" length="5" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="sex_rcd" dataType="DT_STR" length="1" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="home_address_country_rcd" dataType="DT_STR" length="3" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="residence_country_rcd" dataType="DT_STR" length="3" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="primary_service_rcd" dataType="DT_STR" length="5" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="code" dataType="DT_STR" length="40" precision="0" scale="0" codePage="1252"/&gt;&lt;referenceColumn name="policy_code" dataType="DT_WSTR" length="40" precision="0" scale="0" codePage="0"/&gt;&lt;/referenceColumns&gt;&lt;/referenceMetadata&gt;</property>
                <property
                  containsID="true"
                  dataType="System.String"
                  description="Specifies the list of lineage identifiers that map to the parameters that the SQL statement in the SQLCommand property uses. Entries in the list are separated by semicolons."
                  name="ParameterMap">#{Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[patient_id]};#{Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[patient_visit_id]};#{Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[policy_id]};</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Determines whether duplicate keys in the reference data should be treated as errors when full cache mode is used."
                  name="TreatDuplicateKeysAsError">false</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Dump IPD Census\Lookup.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[DBPROD03.AHMC_DataAnalyticsDB]"
                  connectionManagerRefId="Package.ConnectionManagers[DBPROD03.AHMC_DataAnalyticsDB]"
                  description="Connection manager used to access lookup data."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Dump IPD Census\Lookup.Inputs[Lookup Input]"
                  name="Lookup Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Dump IPD Census\Lookup.Inputs[Lookup Input].Columns[patient_id]"
                      cachedDataType="guid"
                      cachedName="patient_id"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[patient_id]">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table that a column joins."
                          name="JoinToReferenceColumn">patient_id</property>
                        <property
                          dataType="System.Null"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn" />
                      </properties>
                    </inputColumn>
                    <inputColumn
                      refId="Package\Dump IPD Census\Lookup.Inputs[Lookup Input].Columns[patient_visit_id]"
                      cachedDataType="guid"
                      cachedName="patient_visit_id"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[patient_visit_id]">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table that a column joins."
                          name="JoinToReferenceColumn">patient_visit_id</property>
                        <property
                          dataType="System.Null"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn" />
                      </properties>
                    </inputColumn>
                    <inputColumn
                      refId="Package\Dump IPD Census\Lookup.Inputs[Lookup Input].Columns[policy_id]"
                      cachedDataType="guid"
                      cachedName="policy_id"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[policy_id]">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table that a column joins."
                          name="JoinToReferenceColumn">policy_id</property>
                        <property
                          dataType="System.Null"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn" />
                      </properties>
                    </inputColumn>
                  </inputColumns>
                  <externalMetadataColumns />
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Dump IPD Census\Lookup.Outputs[Lookup Match Output]"
                  errorOrTruncationOperation="Lookup"
                  exclusionGroup="1"
                  name="Lookup Match Output"
                  synchronousInputId="Package\Dump IPD Census\Lookup.Inputs[Lookup Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Dump IPD Census\Lookup.Outputs[Lookup Match Output].Columns[lkup_patient_id]"
                      dataType="guid"
                      errorOrTruncationOperation="Copy Column"
                      lineageId="Package\Dump IPD Census\Lookup.Outputs[Lookup Match Output].Columns[lkup_patient_id]"
                      name="lkup_patient_id"
                      truncationRowDisposition="FailComponent">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn">patient_id</property>
                      </properties>
                    </outputColumn>
                    <outputColumn
                      refId="Package\Dump IPD Census\Lookup.Outputs[Lookup Match Output].Columns[lkup_patient_visit_id]"
                      dataType="guid"
                      errorOrTruncationOperation="Copy Column"
                      lineageId="Package\Dump IPD Census\Lookup.Outputs[Lookup Match Output].Columns[lkup_patient_visit_id]"
                      name="lkup_patient_visit_id"
                      truncationRowDisposition="FailComponent">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn">patient_visit_id</property>
                      </properties>
                    </outputColumn>
                    <outputColumn
                      refId="Package\Dump IPD Census\Lookup.Outputs[Lookup Match Output].Columns[lkup_policy_id]"
                      dataType="guid"
                      errorOrTruncationOperation="Copy Column"
                      lineageId="Package\Dump IPD Census\Lookup.Outputs[Lookup Match Output].Columns[lkup_policy_id]"
                      name="lkup_policy_id"
                      truncationRowDisposition="FailComponent">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn">policy_id</property>
                      </properties>
                    </outputColumn>
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
                <output
                  refId="Package\Dump IPD Census\Lookup.Outputs[Lookup No Match Output]"
                  description="The Lookup output that handles rows with no matching entries in the reference dataset. Use this output when the NoMatchBehavior property is set to &quot;Send rows with no matching entries to the no match output.&quot;"
                  exclusionGroup="1"
                  name="Lookup No Match Output"
                  synchronousInputId="Package\Dump IPD Census\Lookup.Inputs[Lookup Input]">
                  <externalMetadataColumns />
                </output>
                <output
                  refId="Package\Dump IPD Census\Lookup.Outputs[Lookup Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="Lookup Error Output"
                  synchronousInputId="Package\Dump IPD Census\Lookup.Inputs[Lookup Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Dump IPD Census\Lookup.Outputs[Lookup Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census\Lookup.Outputs[Lookup Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Dump IPD Census\Lookup.Outputs[Lookup Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census\Lookup.Outputs[Lookup Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB"
              componentClassID="Microsoft.OLEDBDestination"
              contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="OLE DB Destination"
              name="To AHMC_DataAnalyticsDB"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[ipd_census_2]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepIdentity">false</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepNulls">false</property>
                <property
                  dataType="System.String"
                  description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                  name="FastLoadOptions">TABLOCK,CHECK_CONSTRAINTS</property>
                <property
                  dataType="System.Int32"
                  description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                  name="FastLoadMaxInsertCommitSize">2147483647</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[DBPROD03.AHMC_DataAnalyticsDB]"
                  connectionManagerRefId="Package.ConnectionManagers[DBPROD03.AHMC_DataAnalyticsDB]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input]"
                  errorOrTruncationOperation="Insert"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="OLE DB Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[patient_id]"
                      cachedDataType="guid"
                      cachedName="patient_id"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[patient_id]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[patient_id]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[patient_visit_id]"
                      cachedDataType="guid"
                      cachedName="patient_visit_id"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[patient_visit_id]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[patient_visit_id]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Visit Start]"
                      cachedDataType="dbTimeStamp"
                      cachedName="Visit Start"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Visit Start]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Start]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Expected Discharge Date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="Expected Discharge Date"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Expected Discharge Date]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Expected Discharge Date]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Closure Date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="Closure Date"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Closure Date]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Closure Date]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Visit Type Name]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Visit Type Name"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Visit Type Name]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Type Name]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Visit Reason]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Visit Reason"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Visit Reason]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Reason]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Created By]"
                      cachedDataType="wstr"
                      cachedLength="256"
                      cachedName="Created By"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Created By]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Created By]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Place of Admission]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Place of Admission"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Place of Admission]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Place of Admission]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Length of Stay]"
                      cachedDataType="i4"
                      cachedName="Length of Stay"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Length of Stay]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Length of Stay]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Visit Policies]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Visit Policies"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Visit Policies]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Visit Policies]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[HN]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="20"
                      cachedName="HN"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[HN]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[HN]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Patient Name]"
                      cachedDataType="wstr"
                      cachedLength="256"
                      cachedName="Patient Name"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Patient Name]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Patient Name]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Region]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Region"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Region]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Region]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Subregion]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Subregion"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Subregion]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Subregion]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[City]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="City"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[City]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[City]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Address Type]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="3"
                      cachedName="Address Type"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Address Type]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Address Type]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Age]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="30"
                      cachedName="Age"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Age]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Age]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Date of Birth]"
                      cachedDataType="dbTimeStamp"
                      cachedName="Date of Birth"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Date of Birth]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Date of Birth]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Nationality]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Nationality"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Nationality]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Nationality]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Race]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Race"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Race]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Race]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Ethnic Group]"
                      cachedDataType="nText"
                      cachedName="Ethnic Group"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Ethnic Group]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Ethnic Group]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Religion]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Religion"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Religion]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Religion]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Sex]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Sex"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Sex]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Sex]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Home Country]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Home Country"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Home Country]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Home Country]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Country of Residence]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Country of Residence"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Country of Residence]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Country of Residence]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Home Address]"
                      cachedDataType="wstr"
                      cachedLength="241"
                      cachedName="Home Address"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Home Address]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Home Address]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Primary Service]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Primary Service"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Primary Service]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Primary Service]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Ward]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Ward"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Ward]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Ward]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Room Code]"
                      cachedDataType="wstr"
                      cachedLength="20"
                      cachedName="Room Code"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Room Code]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Room Code]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Room Class Name]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Room Class Name"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Room Class Name]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Room Class Name]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Primary Doctor]"
                      cachedDataType="wstr"
                      cachedLength="256"
                      cachedName="Primary Doctor"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Primary Doctor]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Primary Doctor]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[diagnosis_type_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="5"
                      cachedName="diagnosis_type_rcd"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[diagnosis_type_rcd]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[diagnosis_type_rcd]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Diagnosis]"
                      cachedDataType="nText"
                      cachedName="Diagnosis"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Diagnosis]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Diagnosis]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Discharge Reason]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Discharge Reason"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Reason]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Reason]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Discharge Notes]"
                      cachedDataType="wstr"
                      cachedLength="3000"
                      cachedName="Discharge Notes"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Notes]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Notes]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Discharge Outcome]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Discharge Outcome"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Outcome]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Outcome]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[Discharge Disposition]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Discharge Disposition"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Disposition]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[Discharge Disposition]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[policy_id]"
                      cachedDataType="guid"
                      cachedName="policy_id"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[policy_id]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[policy_id]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[cancelled_date_time]"
                      cachedDataType="dbTimeStamp"
                      cachedName="cancelled_date_time"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[cancelled_date_time]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[cancelled_date_time]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[visit_type_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="6"
                      cachedName="visit_type_rcd"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[visit_type_rcd]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[visit_type_rcd]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[nationality_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="3"
                      cachedName="nationality_rcd"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[nationality_rcd]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[nationality_rcd]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[ethnic_group_rcd_list]"
                      cachedDataType="nText"
                      cachedName="ethnic_group_rcd_list"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[ethnic_group_rcd_list]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[ethnic_group_rcd_list]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[religion_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="5"
                      cachedName="religion_rcd"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[religion_rcd]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[religion_rcd]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[sex_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="1"
                      cachedName="sex_rcd"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[sex_rcd]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[sex_rcd]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[home_address_country_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="3"
                      cachedName="home_address_country_rcd"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[home_address_country_rcd]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[home_address_country_rcd]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[residence_country_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="3"
                      cachedName="residence_country_rcd"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[residence_country_rcd]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[residence_country_rcd]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[primary_service_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="5"
                      cachedName="primary_service_rcd"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[primary_service_rcd]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[primary_service_rcd]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[code]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="40"
                      cachedName="code"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[code]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].Columns[policy_code]"
                      cachedDataType="wstr"
                      cachedLength="40"
                      cachedName="policy_code"
                      externalMetadataColumnId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[policy_code]"
                      lineageId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output].Columns[policy_code]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[patient_id]"
                      dataType="guid"
                      name="patient_id" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[patient_visit_id]"
                      dataType="guid"
                      name="patient_visit_id" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Visit Start]"
                      dataType="dbTimeStamp"
                      name="Visit Start" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Expected Discharge Date]"
                      dataType="dbTimeStamp"
                      name="Expected Discharge Date" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Closure Date]"
                      dataType="dbTimeStamp"
                      name="Closure Date" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Visit Type Name]"
                      dataType="wstr"
                      length="150"
                      name="Visit Type Name" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Visit Reason]"
                      dataType="wstr"
                      length="150"
                      name="Visit Reason" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Created By]"
                      dataType="wstr"
                      length="256"
                      name="Created By" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Place of Admission]"
                      dataType="wstr"
                      length="150"
                      name="Place of Admission" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Length of Stay]"
                      dataType="i4"
                      name="Length of Stay" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Visit Policies]"
                      dataType="wstr"
                      length="150"
                      name="Visit Policies" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[HN]"
                      codePage="1252"
                      dataType="str"
                      length="20"
                      name="HN" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Patient Name]"
                      dataType="wstr"
                      length="256"
                      name="Patient Name" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Region]"
                      dataType="wstr"
                      length="150"
                      name="Region" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Subregion]"
                      dataType="wstr"
                      length="150"
                      name="Subregion" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[City]"
                      dataType="wstr"
                      length="150"
                      name="City" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Address Type]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="Address Type" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Age]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="Age" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Date of Birth]"
                      dataType="dbTimeStamp"
                      name="Date of Birth" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Nationality]"
                      dataType="wstr"
                      length="150"
                      name="Nationality" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Race]"
                      dataType="wstr"
                      length="150"
                      name="Race" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Ethnic Group]"
                      dataType="nText"
                      name="Ethnic Group" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Religion]"
                      dataType="wstr"
                      length="150"
                      name="Religion" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Sex]"
                      dataType="wstr"
                      length="150"
                      name="Sex" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Home Country]"
                      dataType="wstr"
                      length="150"
                      name="Home Country" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Country of Residence]"
                      dataType="wstr"
                      length="150"
                      name="Country of Residence" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Home Address]"
                      dataType="wstr"
                      length="241"
                      name="Home Address" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Primary Service]"
                      dataType="wstr"
                      length="150"
                      name="Primary Service" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Ward]"
                      dataType="wstr"
                      length="150"
                      name="Ward" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Room Code]"
                      dataType="wstr"
                      length="20"
                      name="Room Code" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Room Class Name]"
                      dataType="wstr"
                      length="150"
                      name="Room Class Name" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Primary Doctor]"
                      dataType="wstr"
                      length="256"
                      name="Primary Doctor" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="diagnosis_type_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Diagnosis]"
                      dataType="nText"
                      name="Diagnosis" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Reason]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Reason" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Notes]"
                      dataType="wstr"
                      length="3000"
                      name="Discharge Notes" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Outcome]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Outcome" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[Discharge Disposition]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Disposition" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[policy_id]"
                      dataType="guid"
                      name="policy_id" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[cancelled_date_time]"
                      dataType="dbTimeStamp"
                      name="cancelled_date_time" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[visit_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      name="visit_type_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[nationality_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="nationality_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[ethnic_group_rcd_list]"
                      dataType="nText"
                      name="ethnic_group_rcd_list" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[religion_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="religion_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[sex_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="sex_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[home_address_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="home_address_country_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[residence_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="residence_country_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[primary_service_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="primary_service_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[code]"
                      codePage="1252"
                      dataType="str"
                      length="40"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input].ExternalColumns[policy_code]"
                      dataType="wstr"
                      length="40"
                      name="policy_code" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Outputs[OLE DB Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="OLE DB Destination Error Output"
                  synchronousInputId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Dump IPD Census.Paths[Lookup No Match Output]"
              endId="Package\Dump IPD Census\To AHMC_DataAnalyticsDB.Inputs[OLE DB Destination Input]"
              name="Lookup No Match Output"
              startId="Package\Dump IPD Census\Lookup.Outputs[Lookup No Match Output]" />
            <path
              refId="Package\Dump IPD Census.Paths[OLE DB Source Output]"
              endId="Package\Dump IPD Census\Lookup.Inputs[Lookup Input]"
              name="OLE DB Source Output"
              startId="Package\Dump IPD Census\From AmalgaPROD.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Dump IPD Census updates"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{732A4310-79FF-49D2-8C43-AAA34E07AE28}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Dump IPD Census updates"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Dump IPD Census updates\Stage table"
              componentClassID="Microsoft.OLEDBDestination"
              contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="OLE DB Destination"
              name="Stage table"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[ipd_census_2_stg]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepIdentity">false</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepNulls">false</property>
                <property
                  dataType="System.String"
                  description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                  name="FastLoadOptions">TABLOCK,CHECK_CONSTRAINTS</property>
                <property
                  dataType="System.Int32"
                  description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                  name="FastLoadMaxInsertCommitSize">2147483647</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Dump IPD Census updates\Stage table.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[DBPROD03.AHMC_DataAnalyticsDB]"
                  connectionManagerRefId="Package.ConnectionManagers[DBPROD03.AHMC_DataAnalyticsDB]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input]"
                  errorOrTruncationOperation="Insert"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="OLE DB Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[patient_id]"
                      cachedDataType="guid"
                      cachedName="patient_id"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[patient_id]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[patient_id]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[patient_visit_id]"
                      cachedDataType="guid"
                      cachedName="patient_visit_id"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[patient_visit_id]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[patient_visit_id]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[Closure Date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="Closure Date"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Closure Date]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Closure Date]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[cancelled_date_time]"
                      cachedDataType="dbTimeStamp"
                      cachedName="cancelled_date_time"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_cancelled_date_time]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[cancelled_date_time]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[Length of Stay]"
                      cachedDataType="i4"
                      cachedName="Length of Stay"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Length of Stay]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Length of Stay]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[Age]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="30"
                      cachedName="Age"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Age]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Age]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[diagnosis_type_rcd]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="5"
                      cachedName="diagnosis_type_rcd"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_diagnosis_type_rcd]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[diagnosis_type_rcd]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[code]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="40"
                      cachedName="code"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_code]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[Diagnosis]"
                      cachedDataType="nText"
                      cachedName="Diagnosis"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Diagnosis]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Diagnosis]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[Discharge Reason]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Discharge Reason"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Discharge Reason]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Reason]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[Discharge Notes]"
                      cachedDataType="wstr"
                      cachedLength="3000"
                      cachedName="Discharge Notes"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Discharge Notes]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Notes]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[Discharge Outcome]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Discharge Outcome"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Discharge Outcome]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Outcome]" />
                    <inputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].Columns[Discharge Disposition]"
                      cachedDataType="wstr"
                      cachedLength="150"
                      cachedName="Discharge Disposition"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Discharge Disposition]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Disposition]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[patient_id]"
                      dataType="guid"
                      name="patient_id" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[patient_visit_id]"
                      dataType="guid"
                      name="patient_visit_id" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Closure Date]"
                      dataType="dbTimeStamp"
                      name="lkup_Closure Date" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_cancelled_date_time]"
                      dataType="dbTimeStamp"
                      name="lkup_cancelled_date_time" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Length of Stay]"
                      dataType="i4"
                      name="lkup_Length of Stay" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Age]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="lkup_Age" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="lkup_diagnosis_type_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_code]"
                      codePage="1252"
                      dataType="str"
                      length="40"
                      name="lkup_code" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Diagnosis]"
                      dataType="nText"
                      name="lkup_Diagnosis" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Discharge Reason]"
                      dataType="wstr"
                      length="150"
                      name="lkup_Discharge Reason" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Discharge Notes]"
                      dataType="wstr"
                      length="3000"
                      name="lkup_Discharge Notes" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Discharge Outcome]"
                      dataType="wstr"
                      length="150"
                      name="lkup_Discharge Outcome" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input].ExternalColumns[lkup_Discharge Disposition]"
                      dataType="wstr"
                      length="150"
                      name="lkup_Discharge Disposition" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Dump IPD Census updates\Stage table.Outputs[OLE DB Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="OLE DB Destination Error Output"
                  synchronousInputId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census updates\Stage table.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Stage table.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census updates\Stage table.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Dump IPD Census updates\Updates"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="Updates"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">DECLARE @date1 DATETIME
DECLARE @date2 DATETIME

SET @date1 = '01/01/2018 00:00:00.000'
SET @date2 = SSIS.dbo.fn_TwoHRDateTo()
--select count(distinct tempc.patient_visit_id)

--from (

select tempb.patient_id
	   ,tempb.patient_visit_id
	   ,tempb.[Visit Start]
	   ,tempb.[Expected Discharge Date]
	   ,tempb.[Closure Date]
	   ,tempb.cancelled_date_time
	   ,tempb.visit_type_rcd
	   ,tempb.[Visit Type Name]
	   ,tempb.[Visit Reason]
	   ,tempb.[Created By]
	   ,tempb.[Place of Admission]
	   ,tempb.[Length of Stay]
	   ,tempb.[Visit Policies]
	   ,tempb.policy_id
	   ,tempb.policy_code
	   ,tempb.HN
	   ,tempb.[Patient Name]
	   ,tempb.Region
	   ,tempb.Subregion
	   ,tempb.City
	   ,tempb.[Address Type]
	   ,case when tempb.Age is null then (cast(cast((DATEDIFF(dd,tempb.[Date of Birth],GETDATE()) / 365.25) as int) as varchar)) else tempb.Age end as Age
	   ,tempb.[Date of Birth]
	   ,tempb.nationality_rcd
	   ,tempb.Nationality
	   ,tempb.Race
	   ,tempb.ethnic_group_rcd_list
	   ,tempb.[Ethnic Group]
	   ,tempb.religion_rcd
	   ,tempb.Religion
	   ,tempb.sex_rcd
	   ,tempb.Sex
	   ,tempb.home_address_country_rcd
	   ,tempb.[Home Country]
	   ,tempb.residence_country_rcd
	   ,tempb.[Country of Residence]
	   ,tempb.[Home Address]
	   ,tempb.primary_service_rcd
	   ,tempb.[Primary Service]
	   ,tempb.Ward
	   ,tempb.[Room Code]
	   ,tempb.[Room Class Name]
	   ,tempb.[Primary Doctor]
	   ,tempb.diagnosis_type_rcd
	   ,tempb.code
	   ,tempb.Diagnosis
	   ,tempb.[Discharge Reason]
	   ,tempb.[Discharge Notes]
	   ,tempb.[Discharge Outcome]
	   ,tempb.[Discharge Disposition]

from (

select temp.patient_id
	   ,temp.patient_visit_id
	   ,temp.[Visit Start]
	   ,temp.[Expected Discharge Date]
	   ,temp.[Closure Date]
	   ,temp.cancelled_date_time
	   ,temp.visit_type_rcd
	   ,temp.[Visit Type Name]
	   ,temp.[Visit Reason]
	   ,temp.[Created By]
	   ,temp.[Place of Admission]
	   ,temp.[Length of Stay]
	   ,temp.[Visit Policies]
	   ,temp.policy_id
	   ,temp.policy_code
	   ,temp.HN
	   ,temp.[Patient Name]
	   ,temp.Region
	   ,temp.Subregion
	   ,temp.City
	   ,temp.[Address Type]
	   ,temp.Age
	   ,temp.[Date of Birth]
	   ,temp.nationality_rcd
	   ,temp.Nationality
	   ,temp.Race
	   ,temp.ethnic_group_rcd_list
	   ,temp.[Ethnic Group]
	   ,temp.religion_rcd
	   ,temp.Religion
	   ,temp.sex_rcd
	   ,temp.Sex
	   ,temp.home_address_country_rcd
	   ,temp.[Home Country]
	   ,temp.residence_country_rcd
	   ,temp.[Country of Residence]
	   ,temp.[Home Address]
	   ,temp.primary_service_rcd
	   ,temp.[Primary Service]
	   ,temp.Ward
	   ,temp.[Room Code]
	   ,temp.[Room Class Name]
	   ,temp.[Primary Doctor]
	   ,pvdv.diagnosis_type_rcd
	   ,pvdv.coding_type_rcd
	   ,pvdv.active_flag
	   ,pvdv.primary_flag
	   ,pvdv.current_visit_diagnosis_flag
	   ,csed.coding_system_rcd
	   ,csed.code
       ,csed.description as Diagnosis
	   ,temp.[Discharge Reason]
	   ,temp.[Discharge Notes]
	   ,temp.[Discharge Outcome]
	   ,temp.[Discharge Disposition]

from (

select distinct apv.patient_id
	   ,api.patient_visit_id
	   ,api.actual_visit_date_time as [Visit Start]
	   ,api.expected_discharge_date_time as [Expected Discharge Date]
	   ,api.closure_date_time as [Closure Date]
	   ,api.cancelled_date_time
	   ,api.visit_type_rcd
	   ,api.visit_type_name_l as [Visit Type Name]
	   --,stuff((select '; ' + name_l from patient_visit_reason a1 left join visit_reason_ref a2 on a1.visit_reason_rcd = a2.visit_reason_rcd
				--														where a1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Reason]
	   ,vrr.name_l as [Visit Reason]
	   ,emp1.display_name_l as [Created By]
	   ,api.created_from_area_name_l as [Place of Admission]
	   ,datediff(dd,api.actual_visit_date_time,api.closure_date_time) as [Length of Stay]
	   --,stuff((select '; ' + b1.policy_name_l from api_patient_visit_policy_view b1 where b1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Policies]
	   ,ISNULL(apvp.policy_name_l, 'Self Pay') as [Visit Policies]
	   ,apvp.policy_id
	   ,apvp.policy_code
	   ,apv.visible_patient_id as HN
	   ,apv.display_name_l as [Patient Name]
	   ,case when ADNV.city is NULL then city.city_id else ADNV.city_id end as city_id
	   ,case when ADNV.city is NULL then city.name_l else ADNV.city end as City
	   ,case when adnv.city_id is NOT NULL then  (SELECT region_id
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT region_id								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as region_id
	   ,case when adnv.city_id is NOT NULL then  (SELECT name_l
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT name_l								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as Region
	    ,case when adnv.city_id is not NULL then (SELECT subr.subregion_id as subregion
															from AmalgaPROD.dbo.subregion_nl_view subr
															where subr.subregion_id = city.subregion_id) else (SELECT subr.subregion_id as subregion
																												from AmalgaPROD.dbo.subregion_nl_view subr
																												where subr.subregion_id = adnv.subregion_id) end as subregion_id
		,case when adnv.city_id is not NULL then (SELECT subr.name_l as subregion
													from AmalgaPROD.dbo.subregion_nl_view subr
													where subr.subregion_id = adnv.subregion_id) else (SELECT subr.name_l as subregion
																										from AmalgaPROD.dbo.subregion_nl_view subr
																										where subr.subregion_id = adnv.subregion_id) end as Subregion
		,case when panv.person_address_type_rcd is NULL then 'N/A' ELSE panv.person_address_type_rcd end as [Address Type]
		--,datediff(dd,apv.date_of_birth, getdate()) / 365 as Age
		,cast(cast((DATEDIFF(dd,apv.date_of_birth,api.closure_date_time) / 365.25) as int) as varchar) as Age
		,apv.date_of_birth as [Date of Birth]
		,apv.nationality_rcd
		,apv.nationality_name_l as Nationality
		,apv.race_name_l as Race
		,case when apv.ethnic_group_rcd_list is null then 'UNK' else apv.ethnic_group_rcd_list end as ethnic_group_rcd_list
		,case when apv.ethnic_group_name_l_list is null then 'Unknown' else apv.ethnic_group_name_l_list end as [Ethnic Group]
		,apv.religion_rcd
		,apv.religion_name_l as Religion
		,apv.sex_rcd
		,apv.sex_name_l as Sex
		,case when apv.home_address_country_rcd is null then 'UNK' else apv.home_address_country_rcd end as home_address_country_rcd
		,case when apv.home_address_country_name_l is null then 'Unknown' else apv.home_address_country_name_l end as [Home Country]
		,apv.residence_country_rcd
		,apv.residence_country_name_l as [Country of Residence]
		,ISNULL(apv.home_address_line_1_l,'') + ' ' + ISNULL(apv.home_address_line_2_l,'') + ISNULL(apv.home_address_line_3_l,'') as [Home Address]
		,api.primary_service_rcd
		,api.primary_service_name_l as [Primary Service]
		,(select top 1 ward_name_l from bed_entry_info_view t1 
					where t1.patient_visit_id = api.patient_visit_id
					order by start_date_time desc) as Ward
	    ,api.admission_bed_code as [Room Code]
		,api.admission_room_charge_set_name_l as [Room Class Name]
		,[Primary Doctor] = (Select top 1 display_name_l from person_formatted_name_iview pfn 
		                            left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
		                            where cr.employee_id = pfn.person_id
									      and cr.caregiver_role_type_rcd = 'PRIDR'
		                                  and cr.caregiver_role_status_rcd = 'ACTIV'
										  and cr.inactivated_date_time is null
										  order by cr.lu_updated desc)
		,api.discharge_reason_name_l as [Discharge Reason]
		,api.discharge_notes as [Discharge Notes]
		,api.discharge_outcome_name_l as [Discharge Outcome]
		,api.discharge_disposition_name_l as [Discharge Disposition]

FROM api_patient_visit_view api 
			left join api_patient_view apv on api.patient_id = apv.patient_id
			left join user_account ua on api.created_by = ua.user_id
			left join person_formatted_name_iview emp1 on ua.person_id = emp1.person_id
			left join api_patient_visit_policy_view apvp on api.patient_visit_id = apvp.patient_visit_id
			left join address_label_view al on apv.home_address_id = al.address_id
			left join person_address_nl_view panv ON apv.patient_id = panv.person_id
			left join address_nl_view adnv ON al.address_id = adnv.address_id
			left join city_nl_view city on ADNV.city_id = city.city_id
			--left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
			--left join person_formatted_name_iview emp2 on emp2.person_id = cr.employee_id
			left join patient_visit_reason pvr on api.patient_visit_id = pvr.patient_visit_id
			left join visit_reason_ref vrr on pvr.visit_reason_rcd = vrr.visit_reason_rcd
			--left join country_ref cref on apv.home_address_country_rcd = cref.country_rcd


where api.visit_type_rcd in ('V1', 'V2')

) as temp
			left join patient_visit_diagnosis_view pvdv on pvdv.patient_visit_id = temp.patient_visit_id
			left join coding_system_element_description csed on csed.code = pvdv.code

where temp.[Address Type] in ('H1','N/A')
	  and (csed.coding_system_rcd is null or csed.coding_system_rcd in ('ICD10', 'ICD9CM'))
	  --and (pvdv.coding_type_rcd is null or pvdv.coding_type_rcd = 'PRI')
	  and isnull(pvdv.current_visit_diagnosis_flag,0) = 1
      and (select count(*) from patient_visit_diagnosis_view
				where patient_visit_id = pvdv.patient_visit_id
				and current_visit_diagnosis_flag = 1) &gt; 0

UNION ALL

select temp.patient_id
	   ,temp.patient_visit_id
	   ,temp.[Visit Start]
	   ,temp.[Expected Discharge Date]
	   ,temp.[Closure Date]
	   ,temp.cancelled_date_time
	   ,temp.visit_type_rcd
	   ,temp.[Visit Type Name]
	   ,temp.[Visit Reason]
	   ,temp.[Created By]
	   ,temp.[Place of Admission]
	   ,temp.[Length of Stay]
	   ,temp.[Visit Policies]
	   ,temp.policy_id
	   ,temp.policy_code
	   ,temp.HN
	   ,temp.[Patient Name]
	   ,temp.Region
	   ,temp.Subregion
	   ,temp.City
	   ,temp.[Address Type]
	   ,temp.Age
	   ,temp.[Date of Birth]
	   ,temp.nationality_rcd
	   ,temp.Nationality
	   ,temp.Race
	   ,temp.ethnic_group_rcd_list
	   ,temp.[Ethnic Group]
	   ,temp.religion_rcd
	   ,temp.Religion
	   ,temp.sex_rcd
	   ,temp.Sex
	   ,temp.home_address_country_rcd
	   ,temp.[Home Country]
	   ,temp.residence_country_rcd
	   ,temp.[Country of Residence]
	   ,temp.[Home Address]
	   ,temp.primary_service_rcd
	   ,temp.[Primary Service]
	   ,temp.Ward
	   ,temp.[Room Code]
	   ,temp.[Room Class Name]
	   ,temp.[Primary Doctor]
	   ,pvdv.diagnosis_type_rcd
	   ,pvdv.coding_type_rcd
	   ,pvdv.active_flag
	   ,pvdv.primary_flag
	   ,pvdv.current_visit_diagnosis_flag
	   ,csed.coding_system_rcd
	   ,csed.code
       ,csed.description as Diagnosis
	   ,temp.[Discharge Reason]
	   ,temp.[Discharge Notes]
	   ,temp.[Discharge Outcome]
	   ,temp.[Discharge Disposition]

from (

select distinct apv.patient_id
	   ,api.patient_visit_id
	   ,api.actual_visit_date_time as [Visit Start]
	   ,api.expected_discharge_date_time as [Expected Discharge Date]
	   ,api.closure_date_time as [Closure Date]
	   ,api.cancelled_date_time
	   ,api.visit_type_rcd
	   ,api.visit_type_name_l as [Visit Type Name]
	   --,stuff((select '; ' + name_l from patient_visit_reason a1 left join visit_reason_ref a2 on a1.visit_reason_rcd = a2.visit_reason_rcd
				--														where a1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Reason]
	   ,vrr.name_l as [Visit Reason]
	   ,emp1.display_name_l as [Created By]
	   ,api.created_from_area_name_l as [Place of Admission]
	   ,datediff(dd,api.actual_visit_date_time,api.closure_date_time) as [Length of Stay]
	   --,stuff((select '; ' + b1.policy_name_l from api_patient_visit_policy_view b1 where b1.patient_visit_id = api.patient_visit_id
				--														for XML PATH('')),1,1,'') as [Visit Policies]
	   ,ISNULL(apvp.policy_name_l, 'Self Pay') as [Visit Policies]
	   ,apvp.policy_id
	   ,apvp.policy_code
	   ,apv.visible_patient_id as HN
	   ,apv.display_name_l as [Patient Name]
	   ,case when ADNV.city is NULL then city.city_id else ADNV.city_id end as city_id
	   ,case when ADNV.city is NULL then city.name_l else ADNV.city end as City
	   ,case when adnv.city_id is NOT NULL then  (SELECT region_id
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT region_id								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as region_id
	   ,case when adnv.city_id is NOT NULL then  (SELECT name_l
																from AmalgaPROD.dbo.region
																where region_id = (SELECT region_id
																			from AmalgaPROD.dbo.city_nl_view
																			where city_id = adnv.city_id)) 
														else (SELECT name_l								
															from AmalgaPROD.dbo.region
															where region_id = (SELECT region_id
																				from AmalgaPROD.dbo.subregion_nl_view
																				where subregion_id = adnv.subregion_id))  end as Region
	    ,case when adnv.city_id is not NULL then (SELECT subr.subregion_id as subregion
															from AmalgaPROD.dbo.subregion_nl_view subr
															where subr.subregion_id = city.subregion_id) else (SELECT subr.subregion_id as subregion
																												from AmalgaPROD.dbo.subregion_nl_view subr
																												where subr.subregion_id = adnv.subregion_id) end as subregion_id
		,case when adnv.city_id is not NULL then (SELECT subr.name_l as subregion
													from AmalgaPROD.dbo.subregion_nl_view subr
													where subr.subregion_id = adnv.subregion_id) else (SELECT subr.name_l as subregion
																										from AmalgaPROD.dbo.subregion_nl_view subr
																										where subr.subregion_id = adnv.subregion_id) end as Subregion
		,case when panv.person_address_type_rcd is NULL then 'N/A' ELSE panv.person_address_type_rcd end as [Address Type]
		--,datediff(dd,apv.date_of_birth, getdate()) / 365 as Age
		,cast(cast((DATEDIFF(dd,apv.date_of_birth,api.closure_date_time) / 365.25) as int) as varchar) as Age
		,apv.date_of_birth as [Date of Birth]
		,apv.nationality_rcd
		,apv.nationality_name_l as Nationality
		,apv.race_name_l as Race
		,case when apv.ethnic_group_rcd_list is null then 'UNK' else apv.ethnic_group_rcd_list end as ethnic_group_rcd_list
		,case when apv.ethnic_group_name_l_list is null then 'Unknown' else apv.ethnic_group_name_l_list end as [Ethnic Group]
		,apv.religion_rcd
		,apv.religion_name_l as Religion
		,apv.sex_rcd
		,apv.sex_name_l as Sex
		,case when apv.home_address_country_rcd is null then 'UNK' else apv.home_address_country_rcd end as home_address_country_rcd
		,case when apv.home_address_country_name_l is null then 'Unknown' else apv.home_address_country_name_l end as [Home Country]
		,apv.residence_country_rcd
		,apv.residence_country_name_l as [Country of Residence]
		,ISNULL(apv.home_address_line_1_l,'') + ' ' + ISNULL(apv.home_address_line_2_l,'') + ISNULL(apv.home_address_line_3_l,'') as [Home Address]
		,api.primary_service_rcd
		,api.primary_service_name_l as [Primary Service]
		,(select top 1 ward_name_l from bed_entry_info_view t1 
					where t1.patient_visit_id = api.patient_visit_id
					order by start_date_time desc) as Ward
	    ,api.admission_bed_code as [Room Code]
		,api.admission_room_charge_set_name_l as [Room Class Name]
		,[Primary Doctor] = (Select top 1 display_name_l from person_formatted_name_iview pfn 
		                            left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
		                            where cr.employee_id = pfn.person_id
									      and cr.caregiver_role_type_rcd = 'PRIDR'
		                                  and cr.caregiver_role_status_rcd = 'ACTIV'
										  and cr.inactivated_date_time is null
										  order by cr.lu_updated desc)
		,api.discharge_reason_name_l as [Discharge Reason]
		,api.discharge_notes as [Discharge Notes]
		,api.discharge_outcome_name_l as [Discharge Outcome]
		,api.discharge_disposition_name_l as [Discharge Disposition]

FROM api_patient_visit_view api 
			left join api_patient_view apv on api.patient_id = apv.patient_id
			left join user_account ua on api.created_by = ua.user_id
			left join person_formatted_name_iview emp1 on ua.person_id = emp1.person_id
			left join api_patient_visit_policy_view apvp on api.patient_visit_id = apvp.patient_visit_id
			left join address_label_view al on apv.home_address_id = al.address_id
			left join person_address_nl_view panv ON apv.patient_id = panv.person_id
			left join address_nl_view adnv ON al.address_id = adnv.address_id
			left join city_nl_view city on ADNV.city_id = city.city_id
			--left join caregiver_role cr on cr.patient_visit_id = api.patient_visit_id
			--left join person_formatted_name_iview emp2 on emp2.person_id = cr.employee_id
			left join patient_visit_reason pvr on api.patient_visit_id = pvr.patient_visit_id
			left join visit_reason_ref vrr on pvr.visit_reason_rcd = vrr.visit_reason_rcd
			--left join country_ref cref on apv.home_address_country_rcd = cref.country_rcd

where api.visit_type_rcd in ('V1', 'V2')

) as temp
			left join patient_visit_diagnosis_view pvdv on temp.patient_visit_id = pvdv.patient_visit_id
			left join coding_system_element_description csed on pvdv.code = csed.code

where temp.[Address Type] in ('H1','N/A')
	  and (csed.coding_system_rcd is null or csed.coding_system_rcd in ('ICD10', 'ICD9CM'))
	  and (pvdv.coding_type_rcd is null or pvdv.coding_type_rcd = 'PRI')
      and (select count(*) from patient_visit_diagnosis_view
				where patient_visit_id = pvdv.patient_visit_id
				and current_visit_diagnosis_flag = 1) = 0

) as tempb
where tempb.[Closure Date] between @date1 and @date2
	  
--) as tempc</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">2</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\Dump IPD Census updates\Updates.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[DBPROD03.AmalgaPROD]"
                  connectionManagerRefId="Package.ConnectionManagers[DBPROD03.AmalgaPROD]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[patient_id]"
                      dataType="guid"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[patient_id]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[patient_id]"
                      name="patient_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[patient_visit_id]"
                      dataType="guid"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[patient_visit_id]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[patient_visit_id]"
                      name="patient_visit_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Closure Date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Closure Date]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Closure Date]"
                      name="Closure Date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[cancelled_date_time]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[cancelled_date_time]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[cancelled_date_time]"
                      name="cancelled_date_time"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Length of Stay]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Length of Stay]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Length of Stay]"
                      name="Length of Stay"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Age]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Age]"
                      length="30"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Age]"
                      name="Age"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[diagnosis_type_rcd]"
                      length="5"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[diagnosis_type_rcd]"
                      name="diagnosis_type_rcd"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[code]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[code]"
                      length="40"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Diagnosis]"
                      dataType="nText"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Diagnosis]"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Diagnosis]"
                      name="Diagnosis"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Reason]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Discharge Reason]"
                      length="150"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Reason]"
                      name="Discharge Reason"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Notes]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Discharge Notes]"
                      length="3000"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Notes]"
                      name="Discharge Notes"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Outcome]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Discharge Outcome]"
                      length="150"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Outcome]"
                      name="Discharge Outcome"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Disposition]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Discharge Disposition]"
                      length="150"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].Columns[Discharge Disposition]"
                      name="Discharge Disposition"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[patient_id]"
                      dataType="guid"
                      name="patient_id" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[patient_visit_id]"
                      dataType="guid"
                      name="patient_visit_id" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Visit Start]"
                      dataType="dbTimeStamp"
                      name="Visit Start" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Expected Discharge Date]"
                      dataType="dbTimeStamp"
                      name="Expected Discharge Date" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Closure Date]"
                      dataType="dbTimeStamp"
                      name="Closure Date" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[cancelled_date_time]"
                      dataType="dbTimeStamp"
                      name="cancelled_date_time" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[visit_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      name="visit_type_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Visit Type Name]"
                      dataType="wstr"
                      length="150"
                      name="Visit Type Name" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Visit Reason]"
                      dataType="wstr"
                      length="150"
                      name="Visit Reason" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Created By]"
                      dataType="wstr"
                      length="256"
                      name="Created By" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Place of Admission]"
                      dataType="wstr"
                      length="150"
                      name="Place of Admission" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Length of Stay]"
                      dataType="i4"
                      name="Length of Stay" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Visit Policies]"
                      dataType="wstr"
                      length="150"
                      name="Visit Policies" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[policy_id]"
                      dataType="guid"
                      name="policy_id" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[policy_code]"
                      dataType="wstr"
                      length="40"
                      name="policy_code" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[HN]"
                      codePage="1252"
                      dataType="str"
                      length="20"
                      name="HN" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Patient Name]"
                      dataType="wstr"
                      length="256"
                      name="Patient Name" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Region]"
                      dataType="wstr"
                      length="150"
                      name="Region" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Subregion]"
                      dataType="wstr"
                      length="150"
                      name="Subregion" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[City]"
                      dataType="wstr"
                      length="150"
                      name="City" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Address Type]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="Address Type" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Age]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="Age" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Date of Birth]"
                      dataType="dbTimeStamp"
                      name="Date of Birth" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[nationality_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="nationality_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Nationality]"
                      dataType="wstr"
                      length="150"
                      name="Nationality" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Race]"
                      dataType="wstr"
                      length="150"
                      name="Race" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[ethnic_group_rcd_list]"
                      dataType="nText"
                      name="ethnic_group_rcd_list" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Ethnic Group]"
                      dataType="nText"
                      name="Ethnic Group" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[religion_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="religion_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Religion]"
                      dataType="wstr"
                      length="150"
                      name="Religion" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[sex_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="sex_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Sex]"
                      dataType="wstr"
                      length="150"
                      name="Sex" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[home_address_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="home_address_country_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Home Country]"
                      dataType="wstr"
                      length="150"
                      name="Home Country" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[residence_country_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="residence_country_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Country of Residence]"
                      dataType="wstr"
                      length="150"
                      name="Country of Residence" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Home Address]"
                      dataType="wstr"
                      length="241"
                      name="Home Address" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[primary_service_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="primary_service_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Primary Service]"
                      dataType="wstr"
                      length="150"
                      name="Primary Service" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Ward]"
                      dataType="wstr"
                      length="150"
                      name="Ward" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Room Code]"
                      dataType="wstr"
                      length="20"
                      name="Room Code" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Room Class Name]"
                      dataType="wstr"
                      length="150"
                      name="Room Class Name" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Primary Doctor]"
                      dataType="wstr"
                      length="256"
                      name="Primary Doctor" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="diagnosis_type_rcd" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[code]"
                      codePage="1252"
                      dataType="str"
                      length="40"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Diagnosis]"
                      dataType="nText"
                      name="Diagnosis" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Discharge Reason]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Reason" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Discharge Notes]"
                      dataType="wstr"
                      length="3000"
                      name="Discharge Notes" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Discharge Outcome]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Outcome" />
                    <externalMetadataColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output].ExternalColumns[Discharge Disposition]"
                      dataType="wstr"
                      length="150"
                      name="Discharge Disposition" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[patient_id]"
                      dataType="guid"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[patient_id]"
                      name="patient_id" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[patient_visit_id]"
                      dataType="guid"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[patient_visit_id]"
                      name="patient_visit_id" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Closure Date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Closure Date]"
                      name="Closure Date" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[cancelled_date_time]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[cancelled_date_time]"
                      name="cancelled_date_time" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Length of Stay]"
                      dataType="i4"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Length of Stay]"
                      name="Length of Stay" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Age]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Age]"
                      name="Age" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[diagnosis_type_rcd]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[diagnosis_type_rcd]"
                      name="diagnosis_type_rcd" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[code]"
                      codePage="1252"
                      dataType="str"
                      length="40"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Diagnosis]"
                      dataType="nText"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Diagnosis]"
                      name="Diagnosis" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Discharge Reason]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Discharge Reason]"
                      name="Discharge Reason" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Discharge Notes]"
                      dataType="wstr"
                      length="3000"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Discharge Notes]"
                      name="Discharge Notes" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Discharge Outcome]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Discharge Outcome]"
                      name="Discharge Outcome" />
                    <outputColumn
                      refId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Discharge Disposition]"
                      dataType="wstr"
                      length="150"
                      lineageId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Error Output].Columns[Discharge Disposition]"
                      name="Discharge Disposition" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Dump IPD Census updates.Paths[OLE DB Source Output]"
              endId="Package\Dump IPD Census updates\Stage table.Inputs[OLE DB Destination Input]"
              name="OLE DB Source Output"
              startId="Package\Dump IPD Census updates\Updates.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{1C6B587D-8800-4444-8041-831A530872D9}"
      DTS:From="Package\Dump IPD Census"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Dump IPD Census updates" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{B7560966-2FA7-403F-A67F-3DAA987958ED}"
      DTS:From="Package\Dump IPD Census updates"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Another stage table" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{446173C4-8FF8-41E6-AB74-3D2A1074BC2D}"
      DTS:From="Package\Another stage table"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\Apply updates" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{F9F1661E-36AB-431F-A309-B7D4EA5CBA09}"
      DTS:From="Package\Apply updates"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Delete policy_id is not null" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{BAB61646-0E71-4CBA-A1BF-F0E501953028}"
      DTS:From="Package\Delete policy_id is not null"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\Delete policy_id is null" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="sql12">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="171,42"
          Id="Package\Another stage table"
          TopLeft="160,256" />
        <NodeLayout
          Size="146,42"
          Id="Package\Apply updates"
          TopLeft="434,253" />
        <NodeLayout
          Size="203,42"
          Id="Package\Delete policy_id is not null"
          TopLeft="406,349" />
        <NodeLayout
          Size="184,42"
          Id="Package\Delete policy_id is null"
          TopLeft="423,449" />
        <NodeLayout
          Size="164,42"
          Id="Package\Dump IPD Census"
          TopLeft="157,51" />
        <NodeLayout
          Size="205,42"
          Id="Package\Dump IPD Census updates"
          TopLeft="138,158" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="239.75,93">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,65"
              Start="0,0"
              End="0,57.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,57.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="243,200">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,56"
              Start="0,0"
              End="0,48.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,48.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="331,275.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="103,0"
              Start="0,0"
              End="95.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="95.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="507.25,295">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,54"
              Start="0,0"
              End="0,46.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,46.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="511.25,391">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,58"
              Start="0,0"
              End="0,50.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,50.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Another stage table">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="113,42"
          Id="Package\Another stage table\Lookup"
          TopLeft="346,227" />
        <NodeLayout
          Size="170,42"
          Id="Package\Another stage table\From ipd_census_1"
          TopLeft="325,117" />
        <NodeLayout
          Size="144,42"
          Id="Package\Another stage table\Stable table 2"
          TopLeft="334,331" />
        <EdgeLayout
          Id="Package\Another stage table.Paths[OLE DB Source Output]"
          TopLeft="406.25,159">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,68"
              Start="0,0"
              End="0,60.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,60.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Another stage table.Paths[Lookup No Match Output]"
          TopLeft="404.25,269">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,62"
              Start="0,0"
              End="0,54.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,54.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-55.80638671875,21.4453125,111.6127734375,11.609375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Another stage table\Lookup">
    <Properties>
      <Property>
        <Name>OverwriteParamsSQLProp</Name>
        <Value
          type="q2:string">false</Value>
      </Property>
      <Property>
        <Name>UsedTableName</Name>
        <Value
          type="q3:string"></Value>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q4:string">0</Value>
      </Property>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Another stage table\From ipd_census_1">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Another stage table\Stable table 2">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Dump IPD Census">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="113,42"
          Id="Package\Dump IPD Census\Lookup"
          TopLeft="352,224" />
        <NodeLayout
          Size="205,42"
          Id="Package\Dump IPD Census\To AHMC_DataAnalyticsDB"
          TopLeft="310,321" />
        <NodeLayout
          Size="169,42"
          Id="Package\Dump IPD Census\From AmalgaPROD"
          TopLeft="321,122" />
        <EdgeLayout
          Id="Package\Dump IPD Census.Paths[OLE DB Source Output]"
          TopLeft="407,164">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Dump IPD Census.Paths[Lookup No Match Output]"
          TopLeft="410.5,266">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,55"
              Start="0,0"
              End="0,47.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,47.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-55.80638671875,17.9453125,111.6127734375,11.609375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Dump IPD Census\Lookup">
    <Properties>
      <Property>
        <Name>OverwriteParamsSQLProp</Name>
        <Value
          type="q2:string">false</Value>
      </Property>
      <Property>
        <Name>UsedTableName</Name>
        <Value
          type="q3:string">[dbo].[ipd_census_2]</Value>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q4:string">0</Value>
      </Property>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Dump IPD Census\To AHMC_DataAnalyticsDB">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Dump IPD Census\From AmalgaPROD">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Dump IPD Census updates">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="117,42"
          Id="Package\Dump IPD Census updates\Updates"
          TopLeft="330,103" />
        <NodeLayout
          Size="132,42"
          Id="Package\Dump IPD Census updates\Stage table"
          TopLeft="322,257" />
        <EdgeLayout
          Id="Package\Dump IPD Census updates.Paths[OLE DB Source Output]"
          TopLeft="388.25,145">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,112"
              Start="0,0"
              End="0,104.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,104.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Dump IPD Census updates\Stage table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Dump IPD Census updates\Updates">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>